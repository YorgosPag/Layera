{"version":3,"sources":["../src/DraggableFAB.tsx"],"names":["useRef","useState","useEffect","jsx"],"mappings":"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","file":"index.js","sourcesContent":["/**\r\n * DraggableFAB.tsx - Enterprise Draggable Floating Action Button\r\n *\r\n * Single source of truth Œ≥ŒπŒ± draggable functionality œÉŒµ œåŒªŒø œÑŒø Layera ecosystem.\r\n * ŒïŒæŒ±œáŒ∏Œ≠ŒΩ Œ±œÄœå GeoMapNew.tsx Œ≥ŒπŒ± reusability Œ∫Œ±Œπ modularity.\r\n */\r\n\r\nimport React, { useState, useRef, useEffect } from 'react';\r\n\r\nexport interface DraggableFABProps {\r\n  children: React.ReactNode;\r\n  onClick?: () => void;\r\n  size?: 'sm' | 'md' | 'lg';\r\n  position?: 'fixed' | 'viewport-relative';\r\n  initialPosition?: { x?: number; y?: number; right?: number; bottom?: number };\r\n  constrainToViewport?: boolean;\r\n  viewportSelector?: string;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  'data-testid'?: string;\r\n  'aria-label'?: string;\r\n  title?: string;\r\n}\r\n\r\ninterface FabPosition {\r\n  x: number;\r\n  y: number;\r\n}\r\n\r\ninterface DragStart {\r\n  x: number;\r\n  y: number;\r\n  px: number;\r\n  py: number;\r\n}\r\n\r\n/**\r\n * Enterprise DraggableFAB - Single Source of Truth\r\n * Œ•œÄŒøœÉœÑŒ∑œÅŒØŒ∂ŒµŒπ viewport constraints, cross-device dragging, Œ∫Œ±Œπ responsive sizing\r\n */\r\nexport const DraggableFAB: React.FC<DraggableFABProps> = ({\r\n  children,\r\n  onClick,\r\n  size = 'md',\r\n  position = 'fixed',\r\n  initialPosition = { x: 15, y: 15 },\r\n  constrainToViewport = true,\r\n  viewportSelector = '[data-viewport-frame], #geo-viewport',\r\n  className = '',\r\n  style = {},\r\n  'data-testid': testId,\r\n  'aria-label': ariaLabel = 'Floating Action Button',\r\n  title\r\n}) => {\r\n  // üéØ STATE MANAGEMENT Œ±œÄœå GeoMapNew.tsx\r\n  const frameRef = useRef<HTMLDivElement | null>(null);\r\n  const [fabPos, setFabPos] = useState<FabPosition>(() => {\r\n    // Initialize position Œ±œÄœå props\r\n    if (initialPosition.right !== undefined || initialPosition.bottom !== undefined) {\r\n      // Convert right/bottom to x/y if provided\r\n      const x = initialPosition.right !== undefined ?\r\n        (typeof window !== 'undefined' ? window.innerWidth - initialPosition.right - getSizePixels(size) : 15) :\r\n        initialPosition.x ?? 15;\r\n      const y = initialPosition.bottom !== undefined ?\r\n        (typeof window !== 'undefined' ? window.innerHeight - initialPosition.bottom - getSizePixels(size) : 15) :\r\n        initialPosition.y ?? 15;\r\n      return { x, y };\r\n    }\r\n    return { x: initialPosition.x ?? 15, y: initialPosition.y ?? 15 };\r\n  });\r\n  const startRef = useRef<DragStart | null>(null);\r\n\r\n  // üéØ SIZE CONFIGURATION\r\n  const getSizePixels = (sizeStr: 'sm' | 'md' | 'lg'): number => {\r\n    switch (sizeStr) {\r\n      case 'sm': return 48;\r\n      case 'md': return 56;\r\n      case 'lg': return 64;\r\n      default: return 56;\r\n    }\r\n  };\r\n\r\n  const BTN_SIZE = getSizePixels(size);\r\n  const MARGIN = 15;\r\n\r\n  // üéØ VIEWPORT CONSTRAINT LOGIC Œ±œÄœå GeoMapNew.tsx\r\n  useEffect(() => {\r\n    if (!constrainToViewport || position === 'fixed') return;\r\n\r\n    const clamp = () => {\r\n      const frame = document.querySelector(viewportSelector);\r\n      if (!frame) return;\r\n\r\n      const rect = frame.getBoundingClientRect();\r\n      if (!rect.width || !rect.height) return;\r\n\r\n      // Œ£ŒπŒ≥ŒøœÖœÅŒµœçŒøœÖŒºŒµ œåœÑŒπ œÑŒ± œåœÅŒπŒ± ŒµŒØŒΩŒ±Œπ œÉœâœÉœÑŒ¨\r\n      const maxX = Math.max(0, rect.width - BTN_SIZE - MARGIN);\r\n      const maxY = Math.max(0, rect.height - BTN_SIZE - MARGIN);\r\n\r\n      const x = Math.max(MARGIN, Math.min(maxX, fabPos.x));\r\n      const y = Math.max(MARGIN, Math.min(maxY, fabPos.y));\r\n\r\n      if (x !== fabPos.x || y !== fabPos.y) {\r\n        setFabPos({ x, y });\r\n      }\r\n    };\r\n\r\n    clamp();\r\n    window.addEventListener('resize', clamp);\r\n    const visualViewport = window.visualViewport;\r\n    visualViewport?.addEventListener('resize', clamp);\r\n    visualViewport?.addEventListener('scroll', clamp);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', clamp);\r\n      visualViewport?.removeEventListener('resize', clamp);\r\n      visualViewport?.removeEventListener('scroll', clamp);\r\n    };\r\n  }, [fabPos.x, fabPos.y, constrainToViewport, position, viewportSelector, BTN_SIZE]);\r\n\r\n  // üéØ DRAG HANDLER Œ±œÄœå GeoMapNew.tsx\r\n  const handleFabPointerDown = (e: React.PointerEvent) => {\r\n    if (position === 'fixed') return; // Fixed position Œ¥ŒµŒΩ ŒµŒØŒΩŒ±Œπ draggable\r\n\r\n    // ŒëŒΩŒ±Œ∂ŒÆœÑŒ∑œÉŒ∑ œÑŒøœÖ ViewportFrame\r\n    const frame = document.querySelector(viewportSelector);\r\n    if (!frame) return;\r\n\r\n    frameRef.current = frame as HTMLDivElement;\r\n    const rect = frame.getBoundingClientRect();\r\n    (e.currentTarget as HTMLElement).setPointerCapture(e.pointerId);\r\n    startRef.current = { x: e.clientX, y: e.clientY, px: fabPos.x, py: fabPos.y };\r\n\r\n    const onMove = (ev: PointerEvent) => {\r\n      if (!startRef.current || !rect) return;\r\n      const dx = ev.clientX - startRef.current.x;\r\n      const dy = ev.clientY - startRef.current.y;\r\n\r\n      // Œ£ŒπŒ≥ŒøœÖœÅŒµœçŒøœÖŒºŒµ œåœÑŒπ œÑŒ± œåœÅŒπŒ± ŒµŒØŒΩŒ±Œπ œÉœâœÉœÑŒ¨\r\n      const maxX = Math.max(0, rect.width - BTN_SIZE - MARGIN);\r\n      const maxY = Math.max(0, rect.height - BTN_SIZE - MARGIN);\r\n\r\n      const nx = Math.max(MARGIN, Math.min(maxX, startRef.current.px + dx));\r\n      const ny = Math.max(MARGIN, Math.min(maxY, startRef.current.py + dy));\r\n\r\n      setFabPos({ x: nx, y: ny });\r\n    };\r\n\r\n    const onUp = () => {\r\n      startRef.current = null;\r\n      window.removeEventListener('pointermove', onMove);\r\n      window.removeEventListener('pointerup', onUp);\r\n    };\r\n\r\n    window.addEventListener('pointermove', onMove);\r\n    window.addEventListener('pointerup', onUp);\r\n  };\r\n\r\n  // üéØ STYLE COMPUTATION\r\n  const computedStyle: React.CSSProperties = {\r\n    position: position === 'fixed' ? 'absolute' : 'absolute',\r\n    ...(position === 'fixed' ? {\r\n      right: typeof initialPosition.right === 'number' ? `${initialPosition.right}px` : undefined,\r\n      bottom: typeof initialPosition.bottom === 'number' ? `${initialPosition.bottom}px` : undefined,\r\n    } : {\r\n      left: `${fabPos.x}px`,\r\n      top: `${fabPos.y}px`,\r\n    }),\r\n    width: BTN_SIZE,\r\n    height: BTN_SIZE,\r\n    borderRadius: '50%',\r\n    background: 'var(--layera-bg-success, #22C55E)',\r\n    border: '2px solid white',\r\n    boxShadow: '0 2px 8px rgba(0,0,0,0.2)',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    cursor: position === 'fixed' ? 'pointer' : 'grab',\r\n    zIndex: 9999,\r\n    userSelect: 'none',\r\n    touchAction: 'none',\r\n    transition: position === 'fixed' ? 'all 0.2s ease' : 'none',\r\n    ...style\r\n  };\r\n\r\n  return (\r\n    <div\r\n      onPointerDown={handleFabPointerDown}\r\n      onClick={onClick}\r\n      aria-label={ariaLabel}\r\n      title={title}\r\n      data-testid={testId}\r\n      className={className}\r\n      style={computedStyle}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n};"]}