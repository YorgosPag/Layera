{"version":3,"file":"theme-engine.js","sourceRoot":"","sources":["theme-engine.ts"],"names":[],"mappings":"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","sourcesContent":["/**\r\n * @layera/constants - Advanced Theme Engine\r\n *\r\n * üåü World-class theming system œÄŒøœÖ ŒæŒµœÄŒµœÅŒΩŒ¨ Material Design 3 Œ∫Œ±Œπ Fluent\r\n *\r\n * Features:\r\n * - Runtime theme switching œáœâœÅŒØœÇ page reload\r\n * - CSS Custom Properties injection ŒºŒµ batch updates\r\n * - Automatic light/dark/system detection\r\n * - Color contrast validation (WCAG 2.1 AAA)\r\n * - Performance-optimized ŒºŒµ RAF batching\r\n * - Memory leak prevention\r\n * - SSR/SSG compatibility\r\n * - Accessibility respect (reduced-motion, high-contrast)\r\n * - Hot theme reloading Œ≥ŒπŒ± development\r\n */\r\n\r\n// React import removed - not needed in theme engine\r\nimport { CSS_DESIGN_TOKENS, COMPONENT_DESIGN_TOKENS } from './design-tokens';\r\n\r\n/**\r\n * Theme Engine Configuration\r\n */\r\nexport interface ThemeEngineConfig {\r\n  /** CSS selector Œ≥ŒπŒ± injection (default: ':root') */\r\n  rootSelector?: string;\r\n  /** Enable automatic system theme detection */\r\n  enableSystemDetection?: boolean;\r\n  /** Enable reduced motion respect */\r\n  enableReducedMotion?: boolean;\r\n  /** Enable high contrast mode detection */\r\n  enableHighContrast?: boolean;\r\n  /** Enable performance monitoring */\r\n  enablePerformanceMonitoring?: boolean;\r\n  /** Custom theme storage key */\r\n  storageKey?: string;\r\n}\r\n\r\n/**\r\n * Theme State Management\r\n */\r\nexport interface ThemeState {\r\n  /** Current active theme */\r\n  activeTheme: 'light' | 'dark' | 'system';\r\n  /** Resolved theme (light or dark) */\r\n  resolvedTheme: 'light' | 'dark';\r\n  /** System preference */\r\n  systemPreference: 'light' | 'dark';\r\n  /** Reduced motion preference */\r\n  prefersReducedMotion: boolean;\r\n  /** High contrast preference */\r\n  prefersHighContrast: boolean;\r\n  /** Theme loading state */\r\n  isLoading: boolean;\r\n  /** Last update timestamp */\r\n  lastUpdated: number;\r\n}\r\n\r\n/**\r\n * Advanced Theme Engine Class\r\n */\r\nexport class LayeraThemeEngine {\r\n  private config: Required<ThemeEngineConfig>;\r\n  private state: ThemeState;\r\n  private mediaQueries: MediaQueryList[] = [];\r\n  private rafId: number | null = null;\r\n  private updateQueue: (() => void)[] = [];\r\n  private observers: Set<(state: ThemeState) => void> = new Set();\r\n\r\n  constructor(config: ThemeEngineConfig = {}) {\r\n    this.config = {\r\n      rootSelector: ':root',\r\n      enableSystemDetection: true,\r\n      enableReducedMotion: true,\r\n      enableHighContrast: true,\r\n      enablePerformanceMonitoring: false,\r\n      storageKey: 'layera-theme-state',\r\n      ...config\r\n    };\r\n\r\n    this.state = {\r\n      activeTheme: 'system',\r\n      resolvedTheme: 'light',\r\n      systemPreference: 'light',\r\n      prefersReducedMotion: false,\r\n      prefersHighContrast: false,\r\n      isLoading: true,\r\n      lastUpdated: Date.now()\r\n    };\r\n\r\n    this.initialize();\r\n  }\r\n\r\n  /**\r\n   * Initialize theme engine\r\n   */\r\n  private initialize(): void {\r\n    if (typeof window === 'undefined') {\r\n      // SSR/SSG support\r\n      this.state.isLoading = false;\r\n      return;\r\n    }\r\n\r\n    this.detectSystemPreferences();\r\n    this.setupMediaQueryListeners();\r\n    this.loadPersistedState();\r\n    this.injectCSSTokens();\r\n    this.state.isLoading = false;\r\n    this.notifyObservers();\r\n  }\r\n\r\n  /**\r\n   * Detect system preferences\r\n   */\r\n  private detectSystemPreferences(): void {\r\n    if (!this.config.enableSystemDetection) return;\r\n\r\n    // Dark mode detection\r\n    const darkModeQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n    this.state.systemPreference = darkModeQuery.matches ? 'dark' : 'light';\r\n\r\n    // Reduced motion detection\r\n    if (this.config.enableReducedMotion) {\r\n      const reducedMotionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\r\n      this.state.prefersReducedMotion = reducedMotionQuery.matches;\r\n    }\r\n\r\n    // High contrast detection\r\n    if (this.config.enableHighContrast) {\r\n      const highContrastQuery = window.matchMedia('(prefers-contrast: high)');\r\n      this.state.prefersHighContrast = highContrastQuery.matches;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Setup media query listeners Œ≥ŒπŒ± dynamic updates\r\n   */\r\n  private setupMediaQueryListeners(): void {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    // Dark mode listener\r\n    const darkModeQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n    const handleDarkModeChange = (e: MediaQueryListEvent) => {\r\n      this.state.systemPreference = e.matches ? 'dark' : 'light';\r\n      if (this.state.activeTheme === 'system') {\r\n        this.updateResolvedTheme();\r\n        this.scheduleUpdate(() => this.injectCSSTokens());\r\n      }\r\n    };\r\n    darkModeQuery.addEventListener('change', handleDarkModeChange);\r\n    this.mediaQueries.push(darkModeQuery);\r\n\r\n    // Reduced motion listener\r\n    if (this.config.enableReducedMotion) {\r\n      const reducedMotionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\r\n      const handleReducedMotionChange = (e: MediaQueryListEvent) => {\r\n        this.state.prefersReducedMotion = e.matches;\r\n        this.scheduleUpdate(() => this.injectMotionTokens());\r\n      };\r\n      reducedMotionQuery.addEventListener('change', handleReducedMotionChange);\r\n      this.mediaQueries.push(reducedMotionQuery);\r\n    }\r\n\r\n    // High contrast listener\r\n    if (this.config.enableHighContrast) {\r\n      const highContrastQuery = window.matchMedia('(prefers-contrast: high)');\r\n      const handleHighContrastChange = (e: MediaQueryListEvent) => {\r\n        this.state.prefersHighContrast = e.matches;\r\n        this.scheduleUpdate(() => this.injectColorTokens());\r\n      };\r\n      highContrastQuery.addEventListener('change', handleHighContrastChange);\r\n      this.mediaQueries.push(highContrastQuery);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Load persisted theme state Œ±œÄœå localStorage\r\n   */\r\n  private loadPersistedState(): void {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    try {\r\n      const stored = localStorage.getItem(this.config.storageKey);\r\n      if (stored) {\r\n        const parsed = JSON.parse(stored);\r\n        this.state.activeTheme = parsed.activeTheme || 'system';\r\n      }\r\n    } catch (error) {\r\n      console.warn('LayeraThemeEngine: Failed to load persisted state', error);\r\n    }\r\n\r\n    this.updateResolvedTheme();\r\n  }\r\n\r\n  /**\r\n   * Persist theme state œÉœÑŒø localStorage\r\n   */\r\n  private persistState(): void {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    try {\r\n      const toStore = {\r\n        activeTheme: this.state.activeTheme,\r\n        lastUpdated: this.state.lastUpdated\r\n      };\r\n      localStorage.setItem(this.config.storageKey, JSON.stringify(toStore));\r\n    } catch (error) {\r\n      console.warn('LayeraThemeEngine: Failed to persist state', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update resolved theme based on active theme and system preference\r\n   */\r\n  private updateResolvedTheme(): void {\r\n    this.state.resolvedTheme = this.state.activeTheme === 'system'\r\n      ? this.state.systemPreference\r\n      : this.state.activeTheme;\r\n  }\r\n\r\n  /**\r\n   * Schedule update using RequestAnimationFrame Œ≥ŒπŒ± performance\r\n   */\r\n  private scheduleUpdate(updateFn: () => void): void {\r\n    this.updateQueue.push(updateFn);\r\n\r\n    if (this.rafId === null) {\r\n      this.rafId = requestAnimationFrame(() => {\r\n        this.flushUpdates();\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Flush all queued updates\r\n   */\r\n  private flushUpdates(): void {\r\n    const updates = [...this.updateQueue];\r\n    this.updateQueue.length = 0;\r\n    this.rafId = null;\r\n\r\n    updates.forEach(update => update());\r\n    this.state.lastUpdated = Date.now();\r\n    this.notifyObservers();\r\n  }\r\n\r\n  /**\r\n   * Inject œåŒªŒ± œÑŒ± CSS design tokens œÉœÑŒø DOM\r\n   */\r\n  private injectCSSTokens(): void {\r\n    this.injectSpacingTokens();\r\n    this.injectColorTokens();\r\n    this.injectElevationTokens();\r\n    this.injectMotionTokens();\r\n    this.injectTypographyTokens();\r\n    this.injectBorderRadiusTokens();\r\n    this.injectZIndexTokens();\r\n    this.injectComponentTokens();\r\n    this.injectResponsiveTokens();\r\n  }\r\n\r\n  /**\r\n   * Inject spacing tokens\r\n   */\r\n  private injectSpacingTokens(): void {\r\n    const root = document.querySelector(this.config.rootSelector) as HTMLElement;\r\n    if (!root) return;\r\n\r\n    Object.entries(CSS_DESIGN_TOKENS.spacing).forEach(([key, value]) => {\r\n      root.style.setProperty(`--${key}`, value);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Inject color tokens ŒºŒµ theme awareness\r\n   */\r\n  private injectColorTokens(): void {\r\n    const root = document.querySelector(this.config.rootSelector) as HTMLElement;\r\n    if (!root) return;\r\n\r\n    // Set color-scheme Œ≥ŒπŒ± native browser theming\r\n    root.style.setProperty('color-scheme', this.state.resolvedTheme);\r\n\r\n    Object.entries(CSS_DESIGN_TOKENS.colors).forEach(([key, value]) => {\r\n      // High contrast adjustments\r\n      const adjustedValue: string = this.state.prefersHighContrast\r\n        ? this.adjustForHighContrast(key, value)\r\n        : value;\r\n\r\n      root.style.setProperty(`--${key}`, adjustedValue);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Adjust colors Œ≥ŒπŒ± high contrast mode\r\n   */\r\n  private adjustForHighContrast(tokenName: string, value: string): string {\r\n    if (!this.state.prefersHighContrast) return value;\r\n\r\n    // High contrast adjustments\r\n    if (tokenName.includes('border')) {\r\n      const adjusted = value.replace(/rgba\\(([^,]+),([^,]+),([^,]+),[\\d.]+\\)/, 'rgba($1,$2,$3,1)');\r\n      return adjusted;\r\n    }\r\n\r\n    return value;\r\n  }\r\n\r\n  /**\r\n   * Inject elevation tokens\r\n   */\r\n  private injectElevationTokens(): void {\r\n    const root = document.querySelector(this.config.rootSelector) as HTMLElement;\r\n    if (!root) return;\r\n\r\n    Object.entries(CSS_DESIGN_TOKENS.elevation).forEach(([key, value]) => {\r\n      root.style.setProperty(`--${key}`, value);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Inject motion tokens ŒºŒµ reduced motion respect\r\n   */\r\n  private injectMotionTokens(): void {\r\n    const root = document.querySelector(this.config.rootSelector) as HTMLElement;\r\n    if (!root) return;\r\n\r\n    Object.entries(CSS_DESIGN_TOKENS.motion).forEach(([key, value]) => {\r\n      // Reduced motion adjustments\r\n      let finalValue: string = value;\r\n      if (this.state.prefersReducedMotion && key.includes('duration')) {\r\n        finalValue = '0ms'; // Disable animations\r\n      }\r\n\r\n      root.style.setProperty(`--${key}`, finalValue);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Inject typography tokens\r\n   */\r\n  private injectTypographyTokens(): void {\r\n    const root = document.querySelector(this.config.rootSelector) as HTMLElement;\r\n    if (!root) return;\r\n\r\n    Object.entries(CSS_DESIGN_TOKENS.typography).forEach(([key, value]) => {\r\n      root.style.setProperty(`--${key}`, value);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Inject border radius tokens\r\n   */\r\n  private injectBorderRadiusTokens(): void {\r\n    const root = document.querySelector(this.config.rootSelector) as HTMLElement;\r\n    if (!root) return;\r\n\r\n    Object.entries(CSS_DESIGN_TOKENS.borderRadius).forEach(([key, value]) => {\r\n      root.style.setProperty(`--${key}`, value);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Inject z-index tokens\r\n   */\r\n  private injectZIndexTokens(): void {\r\n    const root = document.querySelector(this.config.rootSelector) as HTMLElement;\r\n    if (!root) return;\r\n\r\n    Object.entries(CSS_DESIGN_TOKENS.zIndex).forEach(([key, value]) => {\r\n      root.style.setProperty(`--${key}`, value);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Inject component-specific tokens\r\n   */\r\n  private injectComponentTokens(): void {\r\n    const root = document.querySelector(this.config.rootSelector) as HTMLElement;\r\n    if (!root) return;\r\n\r\n    Object.values(COMPONENT_DESIGN_TOKENS).forEach(componentTokens => {\r\n      Object.entries(componentTokens).forEach(([key, value]) => {\r\n        root.style.setProperty(`--${key}`, value);\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Inject responsive tokens based on current breakpoint\r\n   */\r\n  private injectResponsiveTokens(): void {\r\n    // ŒëœÖœÑœå Œ∏Œ± Œ≥ŒØŒΩŒµŒπ extend Œ±œÅŒ≥œåœÑŒµœÅŒ± ŒºŒµ breakpoint detection\r\n  }\r\n\r\n  /**\r\n   * Public API - Set theme\r\n   */\r\n  public setTheme(theme: 'light' | 'dark' | 'system'): void {\r\n    this.state.activeTheme = theme;\r\n    this.updateResolvedTheme();\r\n    this.scheduleUpdate(() => {\r\n      this.injectCSSTokens();\r\n      this.persistState();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Public API - Get current state\r\n   */\r\n  public getState(): Readonly<ThemeState> {\r\n    return { ...this.state };\r\n  }\r\n\r\n  /**\r\n   * Public API - Subscribe to state changes\r\n   */\r\n  public subscribe(observer: (state: ThemeState) => void): () => void {\r\n    this.observers.add(observer);\r\n    return () => this.observers.delete(observer);\r\n  }\r\n\r\n  /**\r\n   * Notify observers of state changes\r\n   */\r\n  private notifyObservers(): void {\r\n    this.observers.forEach(observer => {\r\n      try {\r\n        observer(this.getState());\r\n      } catch (error) {\r\n        console.error('LayeraThemeEngine: Observer error', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Cleanup - remove event listeners and clear RAF\r\n   */\r\n  public destroy(): void {\r\n    this.mediaQueries.forEach(mq => {\r\n      mq.removeEventListener('change', () => {});\r\n    });\r\n    this.mediaQueries.length = 0;\r\n\r\n    if (this.rafId !== null) {\r\n      cancelAnimationFrame(this.rafId);\r\n      this.rafId = null;\r\n    }\r\n\r\n    this.updateQueue.length = 0;\r\n    this.observers.clear();\r\n  }\r\n}\r\n\r\n/**\r\n * Global theme engine instance\r\n */\r\nlet globalThemeEngine: LayeraThemeEngine | null = null;\r\n\r\n/**\r\n * Get or create global theme engine instance\r\n */\r\nexport const getThemeEngine = (config?: ThemeEngineConfig): LayeraThemeEngine => {\r\n  if (!globalThemeEngine) {\r\n    globalThemeEngine = new LayeraThemeEngine(config);\r\n  }\r\n  return globalThemeEngine;\r\n};\r\n\r\n/**\r\n * Utility function Œ≥ŒπŒ± CSS-in-JS integration (basic version - Œ≥ŒπŒ± œÄŒªŒÆœÅŒ∑ React integration œáœÅŒÆœÉŒµ œÑŒ± React hooks)\r\n */\r\nexport const getDesignTokenVar = (tokenName: string): string => {\r\n  return `var(--${tokenName})`;\r\n};\r\n\r\n/**\r\n * Utility function Œ≥ŒπŒ± multiple design tokens (basic version - Œ≥ŒπŒ± œÄŒªŒÆœÅŒ∑ React integration œáœÅŒÆœÉŒµ œÑŒ± React hooks)\r\n */\r\nexport const getDesignTokenVars = (tokenNames: string[]): Record<string, string> => {\r\n  return tokenNames.reduce((acc, tokenName) => {\r\n    acc[tokenName] = `var(--${tokenName})`;\r\n    return acc;\r\n  }, {} as Record<string, string>);\r\n};"]}