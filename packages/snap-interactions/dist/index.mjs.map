{"version":3,"sources":["../src/hooks/useSnapEngine.ts","../src/components/SnapIndicator.tsx","../src/components/SnapSettingsPanel.tsx","../src/components/SnapCanvas.tsx","../src/index.ts"],"names":["useSnapEngine","useTranslation","useTheme","useNotification","useState","useCallback","jsx","jsxs","Icon","useRef","useEffect","tolerance","Fragment"],"mappings":"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","file":"index.mjs","sourcesContent":["/**\r\n * ü™ù useSnapEngine Hook\r\n * React hook Œ≥ŒπŒ± integration ŒºŒµ SnapEngine\r\n * ŒßœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒµŒØ existing LEGO systems Œ≥ŒπŒ± state management\r\n */\r\n\r\nimport { useEffect, useRef, useState, useCallback, useMemo } from 'react';\r\n\r\n// Import Œ±œÄœå @layera/snap-engine - ŒúŒóŒù Œ±ŒΩŒ±Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉŒµŒπœÇ\r\nimport {\r\n  SnapEngine,\r\n  type SnapResult,\r\n  type SnapConfiguration,\r\n  type Point2D,\r\n  type GeometryEntity,\r\n  type SnapPerformanceMetrics\r\n} from '@layera/snap-engine';\r\n\r\n// Import Œ±œÄœå existing LEGO systems - ŒúŒóŒù Œ±ŒΩŒ±Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉŒµŒπœÇ\r\nimport { useNotification } from '@layera/notifications';\r\nimport { useTranslation } from '@layera/i18n';\r\nimport { SNAP_CONSTANTS } from '@layera/constants';\r\n\r\n// ========================================\r\n// üéØ HOOK INTERFACE\r\n// ========================================\r\n\r\nexport interface UseSnapEngineOptions {\r\n  enabled?: boolean;\r\n  tolerance?: number;\r\n  enabledTypes?: Set<string>;\r\n  debugMode?: boolean;\r\n  onSnapFound?: (result: SnapResult) => void;\r\n  onSnapLost?: () => void;\r\n  onError?: (error: Error) => void;\r\n}\r\n\r\nexport interface UseSnapEngineReturn {\r\n  // Core functionality\r\n  snapEngine: SnapEngine | null;\r\n  snapToPoint: (cursor: Point2D) => Promise<SnapResult>;\r\n\r\n  // State\r\n  isEnabled: boolean;\r\n  lastSnapResult: SnapResult | null;\r\n  isSnapped: boolean;\r\n\r\n  // Geometry management\r\n  addGeometry: (geometry: GeometryEntity) => boolean;\r\n  addGeometries: (geometries: GeometryEntity[]) => SnapPerformanceMetrics;\r\n  removeGeometry: (id: string) => boolean;\r\n  clearGeometries: () => void;\r\n\r\n  // Configuration\r\n  updateConfig: (config: Partial<SnapConfiguration>) => void;\r\n  setEnabled: (enabled: boolean) => void;\r\n  setTolerance: (tolerance: number) => void;\r\n\r\n  // Performance & metrics\r\n  performanceMetrics: SnapPerformanceMetrics;\r\n  rebuildIndex: () => SnapPerformanceMetrics;\r\n\r\n  // Loading states Œ±œÄœå @layera/loading integration\r\n  isIndexing: boolean;\r\n  isCalculating: boolean;\r\n}\r\n\r\n// ========================================\r\n// ü™ù MAIN HOOK IMPLEMENTATION\r\n// ========================================\r\n\r\nexport function useSnapEngine(options: UseSnapEngineOptions = {}): UseSnapEngineReturn {\r\n  // Existing LEGO systems integration - ŒúŒóŒù Œ±ŒΩŒ±Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉŒµŒπœÇ\r\n  const { toast } = useNotification();\r\n  const { t } = useTranslation();\r\n\r\n  // Local state\r\n  const [snapEngine, setSnapEngine] = useState<SnapEngine | null>(null);\r\n  const [lastSnapResult, setLastSnapResult] = useState<SnapResult | null>(null);\r\n  const [isEnabled, setIsEnabledState] = useState(options.enabled ?? true);\r\n  const [performanceMetrics, setPerformanceMetrics] = useState<SnapPerformanceMetrics>({\r\n    searchTime: 0,\r\n    indexTime: 0,\r\n    totalTime: 0,\r\n    geometryCount: 0,\r\n    resultsCount: 0,\r\n    memoryUsage: 0\r\n  });\r\n\r\n  // Loading states Œ≥ŒπŒ± integration ŒºŒµ @layera/loading\r\n  const [isIndexing, setIsIndexing] = useState(false);\r\n  const [isCalculating, setIsCalculating] = useState(false);\r\n\r\n  // Refs Œ≥ŒπŒ± stable callbacks\r\n  const optionsRef = useRef(options);\r\n  optionsRef.current = options;\r\n\r\n  // ========================================\r\n  // üöÄ SNAP ENGINE INITIALIZATION\r\n  // ========================================\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const config: SnapConfiguration = {\r\n        tolerance: options.tolerance ?? SNAP_CONSTANTS.DEFAULT_TOLERANCE,\r\n        enabledTypes: options.enabledTypes ?? new Set(['endpoint', 'midpoint', 'center']),\r\n        priority: SNAP_CONSTANTS.DEFAULT_PRIORITIES,\r\n        maxResults: SNAP_CONSTANTS.MAX_RESULTS,\r\n        performanceLevel: 'medium',\r\n        debugMode: options.debugMode ?? false\r\n      };\r\n\r\n      const engine = new SnapEngine(config);\r\n\r\n      // Setup event listeners\r\n      engine.addEventListener('snap:found', (data) => {\r\n        setLastSnapResult(data.result);\r\n        optionsRef.current.onSnapFound?.(data.result);\r\n\r\n        if (options.debugMode) {\r\n          toast({\r\n            type: 'info',\r\n            message: t('snap.feedback.found', { type: data.result.snapType }),\r\n            duration: 1000\r\n          });\r\n        }\r\n      });\r\n\r\n      engine.addEventListener('snap:lost', () => {\r\n        setLastSnapResult(null);\r\n        optionsRef.current.onSnapLost?.();\r\n      });\r\n\r\n      engine.addEventListener('snap:error', (data) => {\r\n        console.error('Snap engine error:', data.error);\r\n        optionsRef.current.onError?.(data.error);\r\n\r\n        toast({\r\n          type: 'error',\r\n          message: t('snap.errors.calculation_failed'),\r\n          duration: 3000\r\n        });\r\n      });\r\n\r\n      engine.addEventListener('index:rebuilt', (data) => {\r\n        setIsIndexing(false);\r\n        setPerformanceMetrics(prev => ({\r\n          ...prev,\r\n          geometryCount: data.geometryCount,\r\n          indexTime: data.indexTime\r\n        }));\r\n\r\n        if (options.debugMode) {\r\n          toast({\r\n            type: 'success',\r\n            message: t('snap.feedback.index_rebuilt', { count: data.geometryCount }),\r\n            duration: 2000\r\n          });\r\n        }\r\n      });\r\n\r\n      setSnapEngine(engine);\r\n\r\n      return () => {\r\n        engine.dispose();\r\n      };\r\n    } catch (error) {\r\n      console.error('Failed to initialize snap engine:', error);\r\n      optionsRef.current.onError?.(error as Error);\r\n    }\r\n  }, []); // Empty dependency - engine is created once\r\n\r\n  // ========================================\r\n  // üéØ CORE SNAP FUNCTIONALITY\r\n  // ========================================\r\n\r\n  const snapToPoint = useCallback(async (cursor: Point2D): Promise<SnapResult> => {\r\n    if (!snapEngine) {\r\n      return {\r\n        target: null,\r\n        snapped: false,\r\n        distance: Infinity,\r\n        cursor,\r\n        snapPoint: cursor,\r\n        snapType: null\r\n      };\r\n    }\r\n\r\n    try {\r\n      setIsCalculating(true);\r\n      const result = await snapEngine.snapToPoint(cursor);\r\n\r\n      // Update performance metrics\r\n      const metrics = snapEngine.getPerformanceMetrics();\r\n      setPerformanceMetrics(metrics);\r\n\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Snap calculation failed:', error);\r\n      optionsRef.current.onError?.(error as Error);\r\n\r\n      return {\r\n        target: null,\r\n        snapped: false,\r\n        distance: Infinity,\r\n        cursor,\r\n        snapPoint: cursor,\r\n        snapType: null\r\n      };\r\n    } finally {\r\n      setIsCalculating(false);\r\n    }\r\n  }, [snapEngine]);\r\n\r\n  // ========================================\r\n  // üèóÔ∏è GEOMETRY MANAGEMENT\r\n  // ========================================\r\n\r\n  const addGeometry = useCallback((geometry: GeometryEntity): boolean => {\r\n    if (!snapEngine) return false;\r\n    return snapEngine.addGeometry(geometry);\r\n  }, [snapEngine]);\r\n\r\n  const addGeometries = useCallback((geometries: GeometryEntity[]): SnapPerformanceMetrics => {\r\n    if (!snapEngine) {\r\n      return {\r\n        searchTime: 0,\r\n        indexTime: 0,\r\n        totalTime: 0,\r\n        geometryCount: 0,\r\n        resultsCount: 0,\r\n        memoryUsage: 0\r\n      };\r\n    }\r\n\r\n    setIsIndexing(true);\r\n    const metrics = snapEngine.addGeometries(geometries);\r\n    setPerformanceMetrics(metrics);\r\n\r\n    return metrics;\r\n  }, [snapEngine]);\r\n\r\n  const removeGeometry = useCallback((id: string): boolean => {\r\n    if (!snapEngine) return false;\r\n    return snapEngine.removeGeometry(id);\r\n  }, [snapEngine]);\r\n\r\n  const clearGeometries = useCallback((): void => {\r\n    if (!snapEngine) return;\r\n\r\n    snapEngine.clearGeometries();\r\n    setLastSnapResult(null);\r\n    setPerformanceMetrics({\r\n      searchTime: 0,\r\n      indexTime: 0,\r\n      totalTime: 0,\r\n      geometryCount: 0,\r\n      resultsCount: 0,\r\n      memoryUsage: 0\r\n    });\r\n  }, [snapEngine]);\r\n\r\n  // ========================================\r\n  // ‚öôÔ∏è CONFIGURATION MANAGEMENT\r\n  // ========================================\r\n\r\n  const updateConfig = useCallback((config: Partial<SnapConfiguration>): void => {\r\n    if (!snapEngine) return;\r\n    snapEngine.updateConfiguration(config);\r\n  }, [snapEngine]);\r\n\r\n  const setEnabled = useCallback((enabled: boolean): void => {\r\n    setIsEnabledState(enabled);\r\n    if (snapEngine) {\r\n      snapEngine.setEnabled(enabled);\r\n    }\r\n\r\n    if (!enabled) {\r\n      setLastSnapResult(null);\r\n    }\r\n  }, [snapEngine]);\r\n\r\n  const setTolerance = useCallback((tolerance: number): void => {\r\n    if (!snapEngine) return;\r\n    snapEngine.setTolerance(tolerance);\r\n  }, [snapEngine]);\r\n\r\n  const rebuildIndex = useCallback((): SnapPerformanceMetrics => {\r\n    if (!snapEngine) {\r\n      return {\r\n        searchTime: 0,\r\n        indexTime: 0,\r\n        totalTime: 0,\r\n        geometryCount: 0,\r\n        resultsCount: 0,\r\n        memoryUsage: 0\r\n      };\r\n    }\r\n\r\n    setIsIndexing(true);\r\n    const metrics = snapEngine.rebuildIndex();\r\n    setPerformanceMetrics(metrics);\r\n    setIsIndexing(false);\r\n\r\n    return metrics;\r\n  }, [snapEngine]);\r\n\r\n  // ========================================\r\n  // üîç COMPUTED VALUES\r\n  // ========================================\r\n\r\n  const isSnapped = useMemo(() => {\r\n    return lastSnapResult?.snapped ?? false;\r\n  }, [lastSnapResult]);\r\n\r\n  // ========================================\r\n  // üì¶ RETURN INTERFACE\r\n  // ========================================\r\n\r\n  return {\r\n    // Core functionality\r\n    snapEngine,\r\n    snapToPoint,\r\n\r\n    // State\r\n    isEnabled,\r\n    lastSnapResult,\r\n    isSnapped,\r\n\r\n    // Geometry management\r\n    addGeometry,\r\n    addGeometries,\r\n    removeGeometry,\r\n    clearGeometries,\r\n\r\n    // Configuration\r\n    updateConfig,\r\n    setEnabled,\r\n    setTolerance,\r\n\r\n    // Performance & metrics\r\n    performanceMetrics,\r\n    rebuildIndex,\r\n\r\n    // Loading states Œ≥ŒπŒ± @layera/loading integration\r\n    isIndexing,\r\n    isCalculating\r\n  };\r\n}\r\n\r\n// ========================================\r\n// üéØ SPECIALIZED HOOKS\r\n// ========================================\r\n\r\n/**\r\n * Hook Œ≥ŒπŒ± CAD-optimized snap settings\r\n */\r\nexport function useCADSnap(options: Omit<UseSnapEngineOptions, 'enabledTypes'> = {}) {\r\n  return useSnapEngine({\r\n    ...options,\r\n    tolerance: options.tolerance ?? 5,\r\n    enabledTypes: new Set(['endpoint', 'midpoint', 'center', 'vertex', 'intersection'])\r\n  });\r\n}\r\n\r\n/**\r\n * Hook Œ≥ŒπŒ± GIS/mapping-optimized snap settings\r\n */\r\nexport function useGISSnap(options: Omit<UseSnapEngineOptions, 'enabledTypes'> = {}) {\r\n  return useSnapEngine({\r\n    ...options,\r\n    tolerance: options.tolerance ?? 15,\r\n    enabledTypes: new Set(['endpoint', 'vertex', 'nearest'])\r\n  });\r\n}\r\n\r\n/**\r\n * Hook Œ≥ŒπŒ± mobile-optimized snap settings\r\n */\r\nexport function useMobileSnap(options: Omit<UseSnapEngineOptions, 'enabledTypes'> = {}) {\r\n  return useSnapEngine({\r\n    ...options,\r\n    tolerance: options.tolerance ?? 25,\r\n    enabledTypes: new Set(['endpoint', 'vertex'])\r\n  });\r\n}","/**\r\n * üéØ SnapIndicator Component\r\n * Visual indicator Œ≥ŒπŒ± snap points - œáœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒµŒØ existing LEGO systems\r\n */\r\n\r\nimport React from 'react';\r\n\r\n// Import Œ±œÄœå existing LEGO systems - ŒúŒóŒù Œ±ŒΩŒ±Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉŒµŒπœÇ\r\nimport { useTheme } from '@layera/theme-switcher';\r\nimport { useTranslation } from '@layera/i18n';\r\nimport { Icon } from '@layera/icons';\r\n\r\n// Import Œ±œÄœå snap engine\r\nimport type { SnapResult, SnapType } from '@layera/snap-engine';\r\n\r\n// ========================================\r\n// üéØ COMPONENT INTERFACES\r\n// ========================================\r\n\r\nexport interface SnapIndicatorProps {\r\n  snapResult: SnapResult;\r\n  visible: boolean;\r\n  size?: number;\r\n  animated?: boolean;\r\n  showTooltip?: boolean;\r\n  className?: string;\r\n}\r\n\r\n// ========================================\r\n// üé® SNAP TYPE VISUAL MAPPING\r\n// ========================================\r\n\r\nconst SNAP_ICONS: Record<SnapType, string> = {\r\n  endpoint: 'square',\r\n  midpoint: 'triangle',\r\n  center: 'circle',\r\n  vertex: 'diamond',\r\n  intersection: 'cross',\r\n  perpendicular: 'perpendicular',\r\n  tangent: 'tangent',\r\n  nearest: 'target',\r\n  grid: 'grid',\r\n  edge: 'line'\r\n};\r\n\r\nconst SNAP_COLORS = {\r\n  light: {\r\n    endpoint: '#ff6b6b',\r\n    midpoint: '#4ecdc4',\r\n    center: '#45b7d1',\r\n    vertex: '#96ceb4',\r\n    intersection: '#ffeaa7',\r\n    perpendicular: '#dda0dd',\r\n    tangent: '#98d8c8',\r\n    nearest: '#f7dc6f',\r\n    grid: '#bb8fce',\r\n    edge: '#85c1e9'\r\n  },\r\n  dark: {\r\n    endpoint: '#e74c3c',\r\n    midpoint: '#1abc9c',\r\n    center: '#3498db',\r\n    vertex: '#2ecc71',\r\n    intersection: '#f39c12',\r\n    perpendicular: '#9b59b6',\r\n    tangent: '#16a085',\r\n    nearest: '#f1c40f',\r\n    grid: '#8e44ad',\r\n    edge: '#2980b9'\r\n  }\r\n};\r\n\r\n// ========================================\r\n// üéØ SNAP INDICATOR COMPONENT\r\n// ========================================\r\n\r\nexport const SnapIndicator: React.FC<SnapIndicatorProps> = ({\r\n  snapResult,\r\n  visible,\r\n  size = 16,\r\n  animated = true,\r\n  showTooltip = true,\r\n  className = ''\r\n}) => {\r\n  // Existing LEGO systems integration - ŒúŒóŒù Œ±ŒΩŒ±Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉŒµŒπœÇ\r\n  const { theme } = useTheme();\r\n  const { t } = useTranslation();\r\n\r\n  // Early return Œ±ŒΩ Œ¥ŒµŒΩ ŒµŒØŒΩŒ±Œπ snapped ŒÆ visible\r\n  if (!visible || !snapResult.snapped || !snapResult.target) {\r\n    return null;\r\n  }\r\n\r\n  const { target, snapPoint, snapType } = snapResult;\r\n  const iconName = SNAP_ICONS[snapType!] || 'circle';\r\n  const colors = SNAP_COLORS[theme] || SNAP_COLORS.light;\r\n  const color = colors[snapType!] || colors.nearest;\r\n\r\n  // ========================================\r\n  // üé® STYLES - ŒßœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒµŒØ theme Œ±œÄœå @layera/theme-switcher\r\n  // ========================================\r\n\r\n  const indicatorStyle: React.CSSProperties = {\r\n    position: 'absolute',\r\n    left: snapPoint.x - size / 2,\r\n    top: snapPoint.y - size / 2,\r\n    width: size,\r\n    height: size,\r\n    pointerEvents: 'none',\r\n    zIndex: 10000,\r\n    borderRadius: '50%',\r\n    backgroundColor: color,\r\n    border: `2px solid ${theme === 'dark' ? '#ffffff' : '#000000'}`,\r\n    boxShadow: `0 0 8px ${color}`,\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    transform: animated ? 'scale(1)' : 'scale(1)',\r\n    transition: animated ? 'all 0.2s ease-in-out' : 'none',\r\n    animation: animated ? 'snapPulse 0.6s ease-in-out' : 'none'\r\n  };\r\n\r\n  const tooltipStyle: React.CSSProperties = {\r\n    position: 'absolute',\r\n    bottom: '100%',\r\n    left: '50%',\r\n    transform: 'translateX(-50%)',\r\n    marginBottom: '8px',\r\n    padding: '4px 8px',\r\n    backgroundColor: theme === 'dark' ? '#2c3e50' : '#ecf0f1',\r\n    color: theme === 'dark' ? '#ecf0f1' : '#2c3e50',\r\n    border: `1px solid ${theme === 'dark' ? '#34495e' : '#bdc3c7'}`,\r\n    borderRadius: '4px',\r\n    fontSize: '12px',\r\n    fontWeight: 500,\r\n    whiteSpace: 'nowrap',\r\n    boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\r\n    zIndex: 10001\r\n  };\r\n\r\n  // ========================================\r\n  // üìù TOOLTIP CONTENT - ŒßœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒµŒØ @layera/i18n\r\n  // ========================================\r\n\r\n  const tooltipContent = showTooltip ? (\r\n    <div style={tooltipStyle}>\r\n      {t(`snap.types.${snapType}`, { defaultValue: snapType })}\r\n      {target.metadata?.layer && (\r\n        <div style={{ fontSize: '10px', opacity: 0.8 }}>\r\n          {t('snap.layer')}: {target.metadata.layer}\r\n        </div>\r\n      )}\r\n    </div>\r\n  ) : null;\r\n\r\n  // ========================================\r\n  // üéØ RENDER\r\n  // ========================================\r\n\r\n  return (\r\n    <div style={indicatorStyle} className={className}>\r\n      {/* Icon Œ±œÄœå @layera/icons - ŒúŒóŒù Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉŒµŒπœÇ custom icons */}\r\n      <Icon\r\n        name={iconName}\r\n        size={size * 0.6}\r\n        color={theme === 'dark' ? '#ffffff' : '#000000'}\r\n      />\r\n\r\n      {/* Tooltip */}\r\n      {tooltipContent}\r\n\r\n      {/* CSS Animation Œ≥ŒπŒ± pulse effect */}\r\n      <style>{`\r\n        @keyframes snapPulse {\r\n          0% {\r\n            transform: scale(0.8);\r\n            opacity: 0.6;\r\n          }\r\n          50% {\r\n            transform: scale(1.2);\r\n            opacity: 1;\r\n          }\r\n          100% {\r\n            transform: scale(1);\r\n            opacity: 1;\r\n          }\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n\r\n// ========================================\r\n// üéØ SNAP CURSOR COMPONENT\r\n// ========================================\r\n\r\nexport interface SnapCursorProps {\r\n  snapResult: SnapResult;\r\n  cursorPosition: { x: number; y: number };\r\n  visible: boolean;\r\n  size?: number;\r\n}\r\n\r\nexport const SnapCursor: React.FC<SnapCursorProps> = ({\r\n  snapResult,\r\n  cursorPosition,\r\n  visible,\r\n  size = 24\r\n}) => {\r\n  const { theme } = useTheme();\r\n\r\n  if (!visible) return null;\r\n\r\n  const isSnapped = snapResult.snapped;\r\n  const position = isSnapped ? snapResult.snapPoint : cursorPosition;\r\n\r\n  const cursorStyle: React.CSSProperties = {\r\n    position: 'absolute',\r\n    left: position.x - size / 2,\r\n    top: position.y - size / 2,\r\n    width: size,\r\n    height: size,\r\n    pointerEvents: 'none',\r\n    zIndex: 9999,\r\n    border: `2px solid ${isSnapped ? '#e74c3c' : theme === 'dark' ? '#ecf0f1' : '#2c3e50'}`,\r\n    borderRadius: '50%',\r\n    backgroundColor: isSnapped ? 'rgba(231, 76, 60, 0.2)' : 'transparent',\r\n    transition: 'all 0.1s ease-out',\r\n    transform: isSnapped ? 'scale(1.2)' : 'scale(1)'\r\n  };\r\n\r\n  return <div style={cursorStyle} />;\r\n};\r\n\r\n// ========================================\r\n// üéØ SNAP GUIDELINES COMPONENT\r\n// ========================================\r\n\r\nexport interface SnapGuidelinesProps {\r\n  snapResult: SnapResult;\r\n  cursorPosition: { x: number; y: number };\r\n  visible: boolean;\r\n  showDistance?: boolean;\r\n}\r\n\r\nexport const SnapGuidelines: React.FC<SnapGuidelinesProps> = ({\r\n  snapResult,\r\n  cursorPosition,\r\n  visible,\r\n  showDistance = true\r\n}) => {\r\n  const { theme } = useTheme();\r\n  const { t } = useTranslation();\r\n\r\n  if (!visible || !snapResult.snapped || !snapResult.target) {\r\n    return null;\r\n  }\r\n\r\n  const { snapPoint } = snapResult;\r\n  const lineColor = theme === 'dark' ? '#ecf0f1' : '#2c3e50';\r\n\r\n  // Calculate line Œ±œÄœå cursor œÉŒµ snap point\r\n  const lineStyle: React.CSSProperties = {\r\n    position: 'absolute',\r\n    left: Math.min(cursorPosition.x, snapPoint.x),\r\n    top: Math.min(cursorPosition.y, snapPoint.y),\r\n    width: Math.abs(snapPoint.x - cursorPosition.x),\r\n    height: Math.abs(snapPoint.y - cursorPosition.y),\r\n    pointerEvents: 'none',\r\n    zIndex: 9998,\r\n    borderTop: `1px dashed ${lineColor}`,\r\n    opacity: 0.6,\r\n    transform: `rotate(${Math.atan2(\r\n      snapPoint.y - cursorPosition.y,\r\n      snapPoint.x - cursorPosition.x\r\n    )}rad)`,\r\n    transformOrigin: 'left top'\r\n  };\r\n\r\n  // Distance label\r\n  const distance = Math.round(snapResult.distance);\r\n  const midPointX = (cursorPosition.x + snapPoint.x) / 2;\r\n  const midPointY = (cursorPosition.y + snapPoint.y) / 2;\r\n\r\n  const distanceLabelStyle: React.CSSProperties = {\r\n    position: 'absolute',\r\n    left: midPointX,\r\n    top: midPointY - 20,\r\n    transform: 'translateX(-50%)',\r\n    padding: '2px 6px',\r\n    backgroundColor: theme === 'dark' ? '#2c3e50' : '#ecf0f1',\r\n    color: theme === 'dark' ? '#ecf0f1' : '#2c3e50',\r\n    border: `1px solid ${theme === 'dark' ? '#34495e' : '#bdc3c7'}`,\r\n    borderRadius: '3px',\r\n    fontSize: '11px',\r\n    fontWeight: 500,\r\n    pointerEvents: 'none',\r\n    zIndex: 10000\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Guideline */}\r\n      <div style={lineStyle} />\r\n\r\n      {/* Distance label */}\r\n      {showDistance && distance > 5 && (\r\n        <div style={distanceLabelStyle}>\r\n          {distance}px\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};","/**\r\n * üéõÔ∏è SnapSettingsPanel Component\r\n * Settings panel Œ≥ŒπŒ± snap configuration - œáœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒµŒØ existing LEGO systems\r\n */\r\n\r\nimport React, { useState, useCallback } from 'react';\r\n\r\n// Import Œ±œÄœå existing LEGO systems - ŒúŒóŒù Œ±ŒΩŒ±Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉŒµŒπœÇ\r\nimport { Card, CardHeader, CardContent } from '@layera/cards';\r\nimport { Button, ToggleButton } from '@layera/buttons';\r\nimport { Slider, FormField, FormSection } from '@layera/forms';\r\nimport { Text, Heading } from '@layera/typography';\r\nimport { Stack, Grid } from '@layera/layout';\r\nimport { Icon } from '@layera/icons';\r\nimport { useTheme } from '@layera/theme-switcher';\r\nimport { useTranslation } from '@layera/i18n';\r\nimport { useNotification } from '@layera/notifications';\r\n\r\n// Import Œ±œÄœå snap engine\r\nimport type { SnapType, SnapConfiguration } from '@layera/snap-engine';\r\n\r\n// ========================================\r\n// üéõÔ∏è COMPONENT INTERFACES\r\n// ========================================\r\n\r\nexport interface SnapSettingsPanelProps {\r\n  configuration: SnapConfiguration;\r\n  onConfigChange: (config: Partial<SnapConfiguration>) => void;\r\n  onClose?: () => void;\r\n  compact?: boolean;\r\n  disabled?: boolean;\r\n}\r\n\r\n// ========================================\r\n// üéØ SNAP TYPE CONFIGURATIONS\r\n// ========================================\r\n\r\nconst SNAP_TYPE_INFO: Record<SnapType, {\r\n  icon: string;\r\n  priority: number;\r\n  description: string;\r\n  category: 'basic' | 'advanced' | 'precision';\r\n}> = {\r\n  endpoint: { icon: 'square', priority: 100, description: 'snap.types.endpoint.desc', category: 'basic' },\r\n  midpoint: { icon: 'triangle', priority: 80, description: 'snap.types.midpoint.desc', category: 'basic' },\r\n  center: { icon: 'circle', priority: 90, description: 'snap.types.center.desc', category: 'basic' },\r\n  vertex: { icon: 'diamond', priority: 85, description: 'snap.types.vertex.desc', category: 'basic' },\r\n  intersection: { icon: 'cross', priority: 95, description: 'snap.types.intersection.desc', category: 'advanced' },\r\n  perpendicular: { icon: 'perpendicular', priority: 70, description: 'snap.types.perpendicular.desc', category: 'precision' },\r\n  tangent: { icon: 'tangent', priority: 65, description: 'snap.types.tangent.desc', category: 'precision' },\r\n  nearest: { icon: 'target', priority: 60, description: 'snap.types.nearest.desc', category: 'basic' },\r\n  grid: { icon: 'grid', priority: 50, description: 'snap.types.grid.desc', category: 'advanced' },\r\n  edge: { icon: 'line', priority: 75, description: 'snap.types.edge.desc', category: 'advanced' }\r\n};\r\n\r\n// ========================================\r\n// üéõÔ∏è SNAP SETTINGS PANEL COMPONENT\r\n// ========================================\r\n\r\nexport const SnapSettingsPanel: React.FC<SnapSettingsPanelProps> = ({\r\n  configuration,\r\n  onConfigChange,\r\n  onClose,\r\n  compact = false,\r\n  disabled = false\r\n}) => {\r\n  // Existing LEGO systems integration - ŒúŒóŒù Œ±ŒΩŒ±Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉŒµŒπœÇ\r\n  const { theme } = useTheme();\r\n  const { t } = useTranslation();\r\n  const { toast } = useNotification();\r\n\r\n  // Local state\r\n  const [activeCategory, setActiveCategory] = useState<'basic' | 'advanced' | 'precision'>('basic');\r\n\r\n  // ========================================\r\n  // üîß EVENT HANDLERS\r\n  // ========================================\r\n\r\n  const handleToleranceChange = useCallback((value: number) => {\r\n    onConfigChange({ tolerance: value });\r\n    toast({\r\n      type: 'info',\r\n      message: t('snap.settings.tolerance_changed', { value }),\r\n      duration: 1500\r\n    });\r\n  }, [onConfigChange, toast, t]);\r\n\r\n  const handleSnapTypeToggle = useCallback((type: SnapType, enabled: boolean) => {\r\n    const newEnabledTypes = new Set(configuration.enabledTypes);\r\n\r\n    if (enabled) {\r\n      newEnabledTypes.add(type);\r\n    } else {\r\n      newEnabledTypes.delete(type);\r\n    }\r\n\r\n    onConfigChange({ enabledTypes: newEnabledTypes });\r\n\r\n    toast({\r\n      type: enabled ? 'success' : 'info',\r\n      message: t(`snap.settings.type_${enabled ? 'enabled' : 'disabled'}`, {\r\n        type: t(`snap.types.${type}`)\r\n      }),\r\n      duration: 1500\r\n    });\r\n  }, [configuration.enabledTypes, onConfigChange, toast, t]);\r\n\r\n  const handlePerformanceLevelChange = useCallback((level: 'high' | 'medium' | 'low') => {\r\n    onConfigChange({ performanceLevel: level });\r\n    toast({\r\n      type: 'info',\r\n      message: t('snap.settings.performance_changed', { level: t(`snap.performance.${level}`) }),\r\n      duration: 2000\r\n    });\r\n  }, [onConfigChange, toast, t]);\r\n\r\n  const handleResetToDefaults = useCallback(() => {\r\n    const defaultConfig: Partial<SnapConfiguration> = {\r\n      tolerance: 10,\r\n      enabledTypes: new Set(['endpoint', 'midpoint', 'center']),\r\n      performanceLevel: 'medium'\r\n    };\r\n\r\n    onConfigChange(defaultConfig);\r\n    toast({\r\n      type: 'success',\r\n      message: t('snap.settings.reset_success'),\r\n      duration: 2000\r\n    });\r\n  }, [onConfigChange, toast, t]);\r\n\r\n  // ========================================\r\n  // üé® RENDER HELPERS\r\n  // ========================================\r\n\r\n  const renderSnapTypeToggle = (type: SnapType) => {\r\n    const info = SNAP_TYPE_INFO[type];\r\n    const isEnabled = configuration.enabledTypes.has(type);\r\n\r\n    return (\r\n      <FormField\r\n        key={type}\r\n        label={\r\n          <Stack direction=\"row\" spacing={8} align=\"center\">\r\n            <Icon name={info.icon} size={16} />\r\n            <Text variant=\"body2\" weight=\"medium\">\r\n              {t(`snap.types.${type}`)}\r\n            </Text>\r\n          </Stack>\r\n        }\r\n        description={compact ? undefined : t(info.description)}\r\n      >\r\n        <ToggleButton\r\n          active={isEnabled}\r\n          disabled={disabled}\r\n          onClick={() => handleSnapTypeToggle(type, !isEnabled)}\r\n          size={compact ? 'small' : 'medium'}\r\n        >\r\n          {isEnabled ? t('common.enabled') : t('common.disabled')}\r\n        </ToggleButton>\r\n      </FormField>\r\n    );\r\n  };\r\n\r\n  const renderCategorySection = (category: 'basic' | 'advanced' | 'precision') => {\r\n    const types = Object.entries(SNAP_TYPE_INFO)\r\n      .filter(([, info]) => info.category === category)\r\n      .map(([type]) => type as SnapType);\r\n\r\n    if (types.length === 0) return null;\r\n\r\n    return (\r\n      <FormSection\r\n        title={t(`snap.categories.${category}`)}\r\n        collapsible={!compact}\r\n        defaultExpanded={category === activeCategory}\r\n      >\r\n        <Stack spacing={compact ? 8 : 12}>\r\n          {types.map(renderSnapTypeToggle)}\r\n        </Stack>\r\n      </FormSection>\r\n    );\r\n  };\r\n\r\n  // ========================================\r\n  // üéõÔ∏è MAIN RENDER\r\n  // ========================================\r\n\r\n  return (\r\n    <Card className={compact ? 'snap-settings-compact' : 'snap-settings-full'}>\r\n      {/* Header ŒºŒµ @layera/cards, @layera/typography, @layera/buttons */}\r\n      <CardHeader>\r\n        <Stack direction=\"row\" justify=\"space-between\" align=\"center\">\r\n          <Stack direction=\"row\" spacing={8} align=\"center\">\r\n            <Icon name=\"settings\" size={20} />\r\n            <Heading level={compact ? 4 : 3}>\r\n              {t('snap.settings.title')}\r\n            </Heading>\r\n          </Stack>\r\n\r\n          {onClose && (\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"small\"\r\n              onClick={onClose}\r\n              disabled={disabled}\r\n            >\r\n              <Icon name=\"close\" size={16} />\r\n            </Button>\r\n          )}\r\n        </Stack>\r\n      </CardHeader>\r\n\r\n      <CardContent>\r\n        <Stack spacing={compact ? 16 : 24}>\r\n          {/* Tolerance Slider ŒºŒµ @layera/forms */}\r\n          <FormSection title={t('snap.settings.tolerance.title')}>\r\n            <FormField\r\n              label={t('snap.settings.tolerance.label')}\r\n              description={!compact ? t('snap.settings.tolerance.description') : undefined}\r\n            >\r\n              <Stack spacing={8}>\r\n                <Slider\r\n                  min={1}\r\n                  max={50}\r\n                  step={1}\r\n                  value={configuration.tolerance}\r\n                  onChange={handleToleranceChange}\r\n                  disabled={disabled}\r\n                  showValue\r\n                  formatValue={(value) => `${value}px`}\r\n                />\r\n                <Text variant=\"caption\" color=\"muted\">\r\n                  {t('snap.settings.tolerance.current', { value: configuration.tolerance })}\r\n                </Text>\r\n              </Stack>\r\n            </FormField>\r\n          </FormSection>\r\n\r\n          {/* Snap Types ŒºŒµ category tabs */}\r\n          <FormSection title={t('snap.settings.types.title')}>\r\n            {/* Category Navigation Œ≥ŒπŒ± non-compact mode */}\r\n            {!compact && (\r\n              <Stack direction=\"row\" spacing={8} style={{ marginBottom: 16 }}>\r\n                {(['basic', 'advanced', 'precision'] as const).map(category => (\r\n                  <Button\r\n                    key={category}\r\n                    variant={activeCategory === category ? 'primary' : 'outline'}\r\n                    size=\"small\"\r\n                    onClick={() => setActiveCategory(category)}\r\n                    disabled={disabled}\r\n                  >\r\n                    {t(`snap.categories.${category}`)}\r\n                  </Button>\r\n                ))}\r\n              </Stack>\r\n            )}\r\n\r\n            {/* Render categories */}\r\n            {compact ? (\r\n              // Compact mode - show all in grid\r\n              <Grid columns={2} spacing={8}>\r\n                {Object.keys(SNAP_TYPE_INFO).map(type =>\r\n                  renderSnapTypeToggle(type as SnapType)\r\n                )}\r\n              </Grid>\r\n            ) : (\r\n              // Full mode - show by category\r\n              <Stack spacing={16}>\r\n                {renderCategorySection('basic')}\r\n                {renderCategorySection('advanced')}\r\n                {renderCategorySection('precision')}\r\n              </Stack>\r\n            )}\r\n          </FormSection>\r\n\r\n          {/* Performance Level */}\r\n          <FormSection title={t('snap.settings.performance.title')}>\r\n            <FormField\r\n              label={t('snap.settings.performance.label')}\r\n              description={!compact ? t('snap.settings.performance.description') : undefined}\r\n            >\r\n              <Stack direction=\"row\" spacing={8}>\r\n                {(['low', 'medium', 'high'] as const).map(level => (\r\n                  <Button\r\n                    key={level}\r\n                    variant={configuration.performanceLevel === level ? 'primary' : 'outline'}\r\n                    size={compact ? 'small' : 'medium'}\r\n                    onClick={() => handlePerformanceLevelChange(level)}\r\n                    disabled={disabled}\r\n                  >\r\n                    {t(`snap.performance.${level}`)}\r\n                  </Button>\r\n                ))}\r\n              </Stack>\r\n            </FormField>\r\n          </FormSection>\r\n\r\n          {/* Actions */}\r\n          <Stack direction=\"row\" spacing={12} justify=\"space-between\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={handleResetToDefaults}\r\n              disabled={disabled}\r\n            >\r\n              <Icon name=\"refresh\" size={16} style={{ marginRight: 8 }} />\r\n              {t('snap.settings.reset_defaults')}\r\n            </Button>\r\n\r\n            {!compact && (\r\n              <Stack direction=\"row\" spacing={8}>\r\n                <Text variant=\"caption\" color=\"muted\">\r\n                  {t('snap.settings.enabled_count', {\r\n                    count: configuration.enabledTypes.size\r\n                  })}\r\n                </Text>\r\n              </Stack>\r\n            )}\r\n          </Stack>\r\n        </Stack>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\n// ========================================\r\n// üéõÔ∏è COMPACT SNAP TOOLBAR\r\n// ========================================\r\n\r\nexport interface SnapToolbarProps {\r\n  configuration: SnapConfiguration;\r\n  onConfigChange: (config: Partial<SnapConfiguration>) => void;\r\n  onOpenSettings?: () => void;\r\n  enabled: boolean;\r\n  onToggleEnabled: (enabled: boolean) => void;\r\n}\r\n\r\nexport const SnapToolbar: React.FC<SnapToolbarProps> = ({\r\n  configuration,\r\n  onConfigChange,\r\n  onOpenSettings,\r\n  enabled,\r\n  onToggleEnabled\r\n}) => {\r\n  const { t } = useTranslation();\r\n\r\n  // Quick toggle Œ≥ŒπŒ± common snap types\r\n  const quickTypes: SnapType[] = ['endpoint', 'midpoint', 'center', 'vertex'];\r\n\r\n  return (\r\n    <Stack direction=\"row\" spacing={8} align=\"center\">\r\n      {/* Master Enable/Disable */}\r\n      <ToggleButton\r\n        active={enabled}\r\n        onClick={() => onToggleEnabled(!enabled)}\r\n        variant=\"primary\"\r\n      >\r\n        <Icon name=\"magnet\" size={16} style={{ marginRight: 4 }} />\r\n        {t('snap.toolbar.snap')}\r\n      </ToggleButton>\r\n\r\n      {/* Quick type toggles */}\r\n      {enabled && quickTypes.map(type => (\r\n        <ToggleButton\r\n          key={type}\r\n          active={configuration.enabledTypes.has(type)}\r\n          onClick={() => {\r\n            const newTypes = new Set(configuration.enabledTypes);\r\n            if (newTypes.has(type)) {\r\n              newTypes.delete(type);\r\n            } else {\r\n              newTypes.add(type);\r\n            }\r\n            onConfigChange({ enabledTypes: newTypes });\r\n          }}\r\n          size=\"small\"\r\n          title={t(`snap.types.${type}`)}\r\n        >\r\n          <Icon name={SNAP_TYPE_INFO[type].icon} size={14} />\r\n        </ToggleButton>\r\n      ))}\r\n\r\n      {/* Settings button */}\r\n      {onOpenSettings && (\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"small\"\r\n          onClick={onOpenSettings}\r\n          title={t('snap.toolbar.open_settings')}\r\n        >\r\n          <Icon name=\"settings\" size={16} />\r\n        </Button>\r\n      )}\r\n\r\n      {/* Tolerance quick adjust */}\r\n      <Stack direction=\"row\" spacing={4} align=\"center\">\r\n        <Text variant=\"caption\" color=\"muted\">\r\n          {configuration.tolerance}px\r\n        </Text>\r\n      </Stack>\r\n    </Stack>\r\n  );\r\n};","/**\r\n * üé® SnapCanvas Component\r\n * Interactive canvas Œ≥ŒπŒ± snap visualization - œáœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒµŒØ existing LEGO systems\r\n */\r\n\r\nimport React, { useRef, useEffect, useCallback, useState } from 'react';\r\n\r\n// Import Œ±œÄœå existing LEGO systems - ŒúŒóŒù Œ±ŒΩŒ±Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉŒµŒπœÇ\r\nimport { useTheme } from '@layera/theme-switcher';\r\nimport { useViewport } from '@layera/viewport';\r\nimport { ErrorBoundary } from '@layera/error-boundary';\r\nimport { LoadingSpinner } from '@layera/loading';\r\n\r\n// Import snap components\r\nimport { SnapIndicator, SnapCursor, SnapGuidelines } from './SnapIndicator';\r\n\r\n// Import Œ±œÄœå snap engine Œ∫Œ±Œπ hooks\r\nimport { useSnapEngine } from '../hooks/useSnapEngine';\r\nimport type { SnapResult, GeometryEntity } from '@layera/snap-engine';\r\n\r\n// ========================================\r\n// üé® COMPONENT INTERFACES\r\n// ========================================\r\n\r\nexport interface SnapCanvasProps {\r\n  width: number;\r\n  height: number;\r\n  geometries: GeometryEntity[];\r\n  onSnapResult?: (result: SnapResult) => void;\r\n  onGeometryAdd?: (geometry: GeometryEntity) => void;\r\n  onGeometrySelect?: (geometry: GeometryEntity) => void;\r\n\r\n  // Visual options\r\n  showSnapIndicators?: boolean;\r\n  showSnapGuidelines?: boolean;\r\n  showSnapCursor?: boolean;\r\n  snapEnabled?: boolean;\r\n  tolerance?: number;\r\n\r\n  // Interaction options\r\n  interactive?: boolean;\r\n  drawingMode?: boolean;\r\n  selectionMode?: boolean;\r\n\r\n  // Styling\r\n  backgroundColor?: string;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n}\r\n\r\ninterface CanvasState {\r\n  cursorPosition: { x: number; y: number };\r\n  lastSnapResult: SnapResult | null;\r\n  isDrawing: boolean;\r\n  selectedGeometry: GeometryEntity | null;\r\n  hoverGeometry: GeometryEntity | null;\r\n}\r\n\r\n// ========================================\r\n// üé® SNAP CANVAS COMPONENT\r\n// ========================================\r\n\r\nexport const SnapCanvas: React.FC<SnapCanvasProps> = ({\r\n  width,\r\n  height,\r\n  geometries,\r\n  onSnapResult,\r\n  onGeometryAdd,\r\n  onGeometrySelect,\r\n\r\n  showSnapIndicators = true,\r\n  showSnapGuidelines = true,\r\n  showSnapCursor = true,\r\n  snapEnabled = true,\r\n  tolerance = 10,\r\n\r\n  interactive = true,\r\n  drawingMode = false,\r\n  selectionMode = false,\r\n\r\n  backgroundColor,\r\n  className = '',\r\n  style = {}\r\n}) => {\r\n  // Existing LEGO systems integration - ŒúŒóŒù Œ±ŒΩŒ±Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉŒµŒπœÇ\r\n  const { theme } = useTheme();\r\n  const { isMobile } = useViewport();\r\n\r\n  // Snap engine integration\r\n  const {\r\n    snapToPoint,\r\n    addGeometries,\r\n    clearGeometries,\r\n    setEnabled,\r\n    setTolerance,\r\n    isIndexing\r\n  } = useSnapEngine({\r\n    enabled: snapEnabled,\r\n    tolerance,\r\n    debugMode: false,\r\n    onSnapFound: onSnapResult,\r\n    onError: (error) => console.error('Snap canvas error:', error)\r\n  });\r\n\r\n  // Refs\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Local state\r\n  const [canvasState, setCanvasState] = useState<CanvasState>({\r\n    cursorPosition: { x: 0, y: 0 },\r\n    lastSnapResult: null,\r\n    isDrawing: false,\r\n    selectedGeometry: null,\r\n    hoverGeometry: null\r\n  });\r\n\r\n  // ========================================\r\n  // üéØ SNAP ENGINE SETUP\r\n  // ========================================\r\n\r\n  useEffect(() => {\r\n    setEnabled(snapEnabled);\r\n  }, [snapEnabled, setEnabled]);\r\n\r\n  useEffect(() => {\r\n    setTolerance(tolerance);\r\n  }, [tolerance, setTolerance]);\r\n\r\n  useEffect(() => {\r\n    // Update geometries œÉœÑŒø snap engine\r\n    clearGeometries();\r\n    if (geometries.length > 0) {\r\n      addGeometries(geometries);\r\n    }\r\n  }, [geometries, clearGeometries, addGeometries]);\r\n\r\n  // ========================================\r\n  // üé® CANVAS RENDERING\r\n  // ========================================\r\n\r\n  const renderGeometries = useCallback((ctx: CanvasRenderingContext2D) => {\r\n    ctx.clearRect(0, 0, width, height);\r\n\r\n    // Background\r\n    ctx.fillStyle = backgroundColor || (theme === 'dark' ? '#2c3e50' : '#ecf0f1');\r\n    ctx.fillRect(0, 0, width, height);\r\n\r\n    // Render geometries\r\n    geometries.forEach(geometry => {\r\n      renderGeometry(ctx, geometry);\r\n    });\r\n  }, [width, height, geometries, backgroundColor, theme]);\r\n\r\n  const renderGeometry = useCallback((ctx: CanvasRenderingContext2D, geometry: GeometryEntity) => {\r\n    if (!geometry.visible) return;\r\n\r\n    // Styling based œÉŒµ selection state\r\n    const isSelected = canvasState.selectedGeometry?.id === geometry.id;\r\n    const isHovered = canvasState.hoverGeometry?.id === geometry.id;\r\n\r\n    ctx.strokeStyle = isSelected ? '#e74c3c' : isHovered ? '#3498db' :\r\n                     theme === 'dark' ? '#ecf0f1' : '#2c3e50';\r\n    ctx.lineWidth = isSelected ? 3 : isHovered ? 2 : 1;\r\n    ctx.fillStyle = geometry.layer === 'osm_buildings' ?\r\n                   'rgba(52, 152, 219, 0.2)' : 'transparent';\r\n\r\n    // Render based on geometry type\r\n    switch (geometry.type) {\r\n      case 'line':\r\n        const line = geometry.data as any;\r\n        ctx.beginPath();\r\n        ctx.moveTo(line.start.x, line.start.y);\r\n        ctx.lineTo(line.end.x, line.end.y);\r\n        ctx.stroke();\r\n        break;\r\n\r\n      case 'circle':\r\n        const circle = geometry.data as any;\r\n        ctx.beginPath();\r\n        ctx.arc(circle.center.x, circle.center.y, circle.radius, 0, 2 * Math.PI);\r\n        ctx.stroke();\r\n        if (ctx.fillStyle !== 'transparent') {\r\n          ctx.fill();\r\n        }\r\n        break;\r\n\r\n      case 'polyline':\r\n      case 'polygon':\r\n        const polyline = geometry.data as any;\r\n        if (polyline.vertices.length > 1) {\r\n          ctx.beginPath();\r\n          ctx.moveTo(polyline.vertices[0].x, polyline.vertices[0].y);\r\n\r\n          for (let i = 1; i < polyline.vertices.length; i++) {\r\n            ctx.lineTo(polyline.vertices[i].x, polyline.vertices[i].y);\r\n          }\r\n\r\n          if (polyline.closed) {\r\n            ctx.closePath();\r\n            if (ctx.fillStyle !== 'transparent') {\r\n              ctx.fill();\r\n            }\r\n          }\r\n          ctx.stroke();\r\n        }\r\n        break;\r\n\r\n      case 'point':\r\n        const point = geometry.data as any;\r\n        ctx.beginPath();\r\n        ctx.arc(point.position.x, point.position.y, 3, 0, 2 * Math.PI);\r\n        ctx.fillStyle = ctx.strokeStyle;\r\n        ctx.fill();\r\n        break;\r\n    }\r\n  }, [canvasState.selectedGeometry, canvasState.hoverGeometry, theme]);\r\n\r\n  // ========================================\r\n  // üñ±Ô∏è MOUSE INTERACTION HANDLERS\r\n  // ========================================\r\n\r\n  const handleMouseMove = useCallback(async (e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    if (!interactive || !canvasRef.current) return;\r\n\r\n    const rect = canvasRef.current.getBoundingClientRect();\r\n    const x = e.clientX - rect.left;\r\n    const y = e.clientY - rect.top;\r\n\r\n    // Update cursor position\r\n    setCanvasState(prev => ({\r\n      ...prev,\r\n      cursorPosition: { x, y }\r\n    }));\r\n\r\n    // Perform snap calculation\r\n    if (snapEnabled) {\r\n      try {\r\n        const snapResult = await snapToPoint({ x, y });\r\n\r\n        setCanvasState(prev => ({\r\n          ...prev,\r\n          lastSnapResult: snapResult\r\n        }));\r\n\r\n        // Call callback\r\n        onSnapResult?.(snapResult);\r\n      } catch (error) {\r\n        console.error('Snap calculation failed:', error);\r\n      }\r\n    }\r\n\r\n    // Hover detection Œ≥ŒπŒ± geometry selection\r\n    if (selectionMode) {\r\n      const hoveredGeometry = findGeometryAtPoint({ x, y });\r\n      setCanvasState(prev => ({\r\n        ...prev,\r\n        hoverGeometry: hoveredGeometry\r\n      }));\r\n    }\r\n  }, [interactive, snapEnabled, snapToPoint, onSnapResult, selectionMode]);\r\n\r\n  const handleMouseClick = useCallback((e: React.MouseEvent<HTMLCanvasElement>) => {\r\n    if (!interactive) return;\r\n\r\n    const rect = canvasRef.current?.getBoundingClientRect();\r\n    if (!rect) return;\r\n\r\n    const x = e.clientX - rect.left;\r\n    const y = e.clientY - rect.top;\r\n\r\n    if (selectionMode) {\r\n      // Select geometry\r\n      const clickedGeometry = findGeometryAtPoint({ x, y });\r\n      setCanvasState(prev => ({\r\n        ...prev,\r\n        selectedGeometry: clickedGeometry\r\n      }));\r\n\r\n      if (clickedGeometry) {\r\n        onGeometrySelect?.(clickedGeometry);\r\n      }\r\n    }\r\n\r\n    if (drawingMode) {\r\n      // Drawing functionality - simplified example\r\n      // Real implementation Œ∏Œ± ŒµŒØœáŒµ Œ¥ŒπŒ¨œÜŒøœÅŒ± drawing tools\r\n      console.log('Drawing at:', { x, y });\r\n    }\r\n  }, [interactive, selectionMode, drawingMode, onGeometrySelect]);\r\n\r\n  const findGeometryAtPoint = useCallback((point: { x: number; y: number }): GeometryEntity | null => {\r\n    // Simple hit testing - production implementation Œ∏Œ± œáœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒøœçœÉŒµ spatial index\r\n    for (const geometry of geometries) {\r\n      if (isPointInGeometry(point, geometry)) {\r\n        return geometry;\r\n      }\r\n    }\r\n    return null;\r\n  }, [geometries]);\r\n\r\n  const isPointInGeometry = (point: { x: number; y: number }, geometry: GeometryEntity): boolean => {\r\n    // Simple bounding box check - real implementation Œ∏Œ± Œ≠Œ∫Œ±ŒΩŒµ accurate hit testing\r\n    const tolerance = 5;\r\n    const bounds = geometry.bounds;\r\n\r\n    return point.x >= bounds.minX - tolerance &&\r\n           point.x <= bounds.maxX + tolerance &&\r\n           point.y >= bounds.minY - tolerance &&\r\n           point.y <= bounds.maxY + tolerance;\r\n  };\r\n\r\n  // ========================================\r\n  // üì± TOUCH HANDLERS Œ≥ŒπŒ± Mobile Support\r\n  // ========================================\r\n\r\n  const handleTouchMove = useCallback((e: React.TouchEvent<HTMLCanvasElement>) => {\r\n    if (!isMobile || !interactive) return;\r\n\r\n    e.preventDefault();\r\n    const touch = e.touches[0];\r\n    const rect = canvasRef.current?.getBoundingClientRect();\r\n    if (!rect) return;\r\n\r\n    const x = touch.clientX - rect.left;\r\n    const y = touch.clientY - rect.top;\r\n\r\n    // Simulate mouse move Œ≥ŒπŒ± mobile\r\n    handleMouseMove({\r\n      clientX: touch.clientX,\r\n      clientY: touch.clientY\r\n    } as any);\r\n  }, [isMobile, interactive, handleMouseMove]);\r\n\r\n  // ========================================\r\n  // üé® CANVAS EFFECT\r\n  // ========================================\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    const ctx = canvas.getContext('2d');\r\n    if (!ctx) return;\r\n\r\n    // Render geometries\r\n    renderGeometries(ctx);\r\n  }, [renderGeometries, canvasState.selectedGeometry, canvasState.hoverGeometry]);\r\n\r\n  // ========================================\r\n  // üéØ RENDER\r\n  // ========================================\r\n\r\n  const containerStyle: React.CSSProperties = {\r\n    position: 'relative',\r\n    width,\r\n    height,\r\n    overflow: 'hidden',\r\n    cursor: interactive ? 'crosshair' : 'default',\r\n    ...style\r\n  };\r\n\r\n  const canvasStyle: React.CSSProperties = {\r\n    display: 'block',\r\n    width: '100%',\r\n    height: '100%'\r\n  };\r\n\r\n  return (\r\n    <ErrorBoundary>\r\n      <div\r\n        ref={containerRef}\r\n        className={`snap-canvas ${className}`}\r\n        style={containerStyle}\r\n      >\r\n        {/* Main Canvas */}\r\n        <canvas\r\n          ref={canvasRef}\r\n          width={width}\r\n          height={height}\r\n          style={canvasStyle}\r\n          onMouseMove={handleMouseMove}\r\n          onClick={handleMouseClick}\r\n          onTouchMove={handleTouchMove}\r\n          onTouchStart={handleTouchMove}\r\n        />\r\n\r\n        {/* Loading Overlay - œáœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒµŒØ @layera/loading */}\r\n        {isIndexing && (\r\n          <div style={{\r\n            position: 'absolute',\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            backgroundColor: 'rgba(0,0,0,0.5)',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            zIndex: 1000\r\n          }}>\r\n            <LoadingSpinner size=\"large\" />\r\n          </div>\r\n        )}\r\n\r\n        {/* Snap Visual Feedback */}\r\n        {snapEnabled && canvasState.lastSnapResult && (\r\n          <>\r\n            {/* Snap Indicator */}\r\n            {showSnapIndicators && (\r\n              <SnapIndicator\r\n                snapResult={canvasState.lastSnapResult}\r\n                visible={true}\r\n                animated={true}\r\n                showTooltip={!isMobile}\r\n              />\r\n            )}\r\n\r\n            {/* Snap Guidelines */}\r\n            {showSnapGuidelines && (\r\n              <SnapGuidelines\r\n                snapResult={canvasState.lastSnapResult}\r\n                cursorPosition={canvasState.cursorPosition}\r\n                visible={true}\r\n                showDistance={!isMobile}\r\n              />\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/* Snap Cursor */}\r\n        {showSnapCursor && interactive && (\r\n          <SnapCursor\r\n            snapResult={canvasState.lastSnapResult || {\r\n              target: null,\r\n              snapped: false,\r\n              distance: Infinity,\r\n              cursor: canvasState.cursorPosition,\r\n              snapPoint: canvasState.cursorPosition,\r\n              snapType: null\r\n            }}\r\n            cursorPosition={canvasState.cursorPosition}\r\n            visible={true}\r\n          />\r\n        )}\r\n      </div>\r\n    </ErrorBoundary>\r\n  );\r\n};\r\n\r\n// ========================================\r\n// üé® PRESET CANVAS CONFIGURATIONS\r\n// ========================================\r\n\r\nexport const CADSnapCanvas: React.FC<Omit<SnapCanvasProps, 'tolerance'>> = (props) => (\r\n  <SnapCanvas {...props} tolerance={5} showSnapGuidelines={true} />\r\n);\r\n\r\nexport const GISSnapCanvas: React.FC<Omit<SnapCanvasProps, 'tolerance'>> = (props) => (\r\n  <SnapCanvas {...props} tolerance={15} showSnapGuidelines={false} />\r\n);\r\n\r\nexport const MobileSnapCanvas: React.FC<Omit<SnapCanvasProps, 'tolerance' | 'showSnapGuidelines'>> = (props) => (\r\n  <SnapCanvas {...props} tolerance={25} showSnapGuidelines={false} />\r\n);","/**\r\n * üé® @layera/snap-interactions\r\n *\r\n * Interactive snap UI components Œ∫Œ±Œπ visual feedback system Œ≥ŒπŒ± Layera LEGO architecture\r\n *\r\n * ŒßœÅŒ∑œÉŒπŒºŒøœÄŒøŒπŒµŒØ existing LEGO systems:\r\n * - @layera/theme-switcher Œ≥ŒπŒ± theming\r\n * - @layera/i18n Œ≥ŒπŒ± internationalization\r\n * - @layera/notifications Œ≥ŒπŒ± user feedback\r\n * - @layera/buttons, @layera/forms, @layera/cards Œ≥ŒπŒ± UI components\r\n * - @layera/icons, @layera/typography, @layera/layout Œ≥ŒπŒ± styling\r\n *\r\n * @author Layera Team\r\n * @version 1.0.0\r\n */\r\n\r\n// ========================================\r\n// ü™ù REACT HOOKS\r\n// ========================================\r\n\r\nexport {\r\n  useSnapEngine,\r\n  useCADSnap,\r\n  useGISSnap,\r\n  useMobileSnap,\r\n  type UseSnapEngineOptions,\r\n  type UseSnapEngineReturn\r\n} from './hooks/useSnapEngine';\r\n\r\n// ========================================\r\n// üé® UI COMPONENTS\r\n// ========================================\r\n\r\n// Snap visualization components\r\nexport {\r\n  SnapIndicator,\r\n  SnapCursor,\r\n  SnapGuidelines,\r\n  type SnapIndicatorProps,\r\n  type SnapCursorProps,\r\n  type SnapGuidelinesProps\r\n} from './components/SnapIndicator';\r\n\r\n// Settings and configuration components\r\nexport {\r\n  SnapSettingsPanel,\r\n  SnapToolbar,\r\n  type SnapSettingsPanelProps,\r\n  type SnapToolbarProps\r\n} from './components/SnapSettingsPanel';\r\n\r\n// Interactive canvas component\r\nexport {\r\n  SnapCanvas,\r\n  CADSnapCanvas,\r\n  GISSnapCanvas,\r\n  MobileSnapCanvas,\r\n  type SnapCanvasProps\r\n} from './components/SnapCanvas';\r\n\r\n// ========================================\r\n// üîß UTILITY FUNCTIONS\r\n// ========================================\r\n\r\n/**\r\n * Creates snap-enabled drawing canvas ŒºŒµ optimized settings\r\n */\r\nexport function createSnapCanvas(\r\n  container: HTMLElement,\r\n  options: {\r\n    width: number;\r\n    height: number;\r\n    mode: 'cad' | 'gis' | 'mobile';\r\n    theme?: 'light' | 'dark';\r\n  }\r\n) {\r\n  // Factory function Œ≥ŒπŒ± programmatic canvas creation\r\n  // This would return a configured SnapCanvas instance\r\n\r\n  const { width, height, mode } = options;\r\n\r\n  const defaultSettings = {\r\n    cad: { tolerance: 5, showGuidelines: true },\r\n    gis: { tolerance: 15, showGuidelines: false },\r\n    mobile: { tolerance: 25, showGuidelines: false }\r\n  };\r\n\r\n  return {\r\n    settings: defaultSettings[mode],\r\n    container,\r\n    dimensions: { width, height }\r\n  };\r\n}\r\n\r\n/**\r\n * Validates snap component props Œ≥ŒπŒ± consistency\r\n */\r\nexport function validateSnapProps(props: Record<string, unknown>): {\r\n  valid: boolean;\r\n  errors: string[];\r\n  warnings: string[];\r\n} {\r\n  const errors: string[] = [];\r\n  const warnings: string[] = [];\r\n\r\n  // Tolerance validation\r\n  if (props.tolerance && (props.tolerance < 1 || props.tolerance > 100)) {\r\n    errors.push('Tolerance must be between 1 and 100 pixels');\r\n  }\r\n\r\n  // Canvas dimensions validation\r\n  if (props.width && props.width < 100) {\r\n    warnings.push('Canvas width is very small, may affect usability');\r\n  }\r\n\r\n  if (props.height && props.height < 100) {\r\n    warnings.push('Canvas height is very small, may affect usability');\r\n  }\r\n\r\n  // Performance warnings\r\n  if (props.geometries && props.geometries.length > 1000) {\r\n    warnings.push('Large number of geometries may impact performance');\r\n  }\r\n\r\n  return {\r\n    valid: errors.length === 0,\r\n    errors,\r\n    warnings\r\n  };\r\n}\r\n\r\n/**\r\n * Default snap interaction configurations\r\n */\r\nexport const SNAP_INTERACTION_DEFAULTS = {\r\n  CAD: {\r\n    tolerance: 5,\r\n    showSnapIndicators: true,\r\n    showSnapGuidelines: true,\r\n    showSnapCursor: true,\r\n    animatedIndicators: true,\r\n    enabledTypes: ['endpoint', 'midpoint', 'center', 'vertex', 'intersection']\r\n  },\r\n  GIS: {\r\n    tolerance: 15,\r\n    showSnapIndicators: true,\r\n    showSnapGuidelines: false,\r\n    showSnapCursor: true,\r\n    animatedIndicators: false,\r\n    enabledTypes: ['endpoint', 'vertex', 'nearest']\r\n  },\r\n  MOBILE: {\r\n    tolerance: 25,\r\n    showSnapIndicators: true,\r\n    showSnapGuidelines: false,\r\n    showSnapCursor: false,\r\n    animatedIndicators: false,\r\n    enabledTypes: ['endpoint', 'vertex']\r\n  }\r\n} as const;\r\n\r\n/**\r\n * Performance optimization helpers\r\n */\r\nexport const SnapPerformanceUtils = {\r\n  /**\r\n   * Calculates optimal snap tolerance based on zoom level\r\n   */\r\n  calculateOptimalTolerance(zoomLevel: number, baselineZoom: number = 1): number {\r\n    const scaleFactor = zoomLevel / baselineZoom;\r\n    return Math.max(5, Math.min(50, 15 / scaleFactor));\r\n  },\r\n\r\n  /**\r\n   * Determines if advanced snap features should be enabled based on performance\r\n   */\r\n  shouldEnableAdvancedFeatures(geometryCount: number, isMobile: boolean): boolean {\r\n    if (isMobile) {\r\n      return geometryCount < 500;\r\n    }\r\n    return geometryCount < 2000;\r\n  },\r\n\r\n  /**\r\n   * Gets recommended snap types based on context\r\n   */\r\n  getRecommendedSnapTypes(\r\n    context: 'cad' | 'gis' | 'mobile',\r\n    performanceLevel: 'high' | 'medium' | 'low'\r\n  ): string[] {\r\n    const baseTypes = {\r\n      cad: ['endpoint', 'midpoint', 'center', 'vertex'],\r\n      gis: ['endpoint', 'vertex', 'nearest'],\r\n      mobile: ['endpoint', 'vertex']\r\n    };\r\n\r\n    const advancedTypes = {\r\n      cad: ['intersection', 'perpendicular', 'tangent'],\r\n      gis: ['center', 'midpoint'],\r\n      mobile: []\r\n    };\r\n\r\n    const base = baseTypes[context] || baseTypes.gis;\r\n\r\n    if (performanceLevel === 'high') {\r\n      return [...base, ...advancedTypes[context]];\r\n    }\r\n\r\n    return base;\r\n  }\r\n};\r\n\r\n// ========================================\r\n// üéØ COMPONENT INTEGRATION HELPERS\r\n// ========================================\r\n\r\n/**\r\n * Higher-order component Œ≥ŒπŒ± snap functionality\r\n */\r\nexport function withSnapSupport<P extends object>(\r\n  Component: React.ComponentType<P>\r\n): React.ComponentType<P & { snapEnabled?: boolean; snapTolerance?: number }> {\r\n  return (props) => {\r\n    const { snapEnabled = true, snapTolerance = 10, ...componentProps } = props;\r\n\r\n    // This would wrap the component with snap context\r\n    // Implementation would provide snap functionality to wrapped component\r\n\r\n    return React.createElement(Component, componentProps as P);\r\n  };\r\n}\r\n\r\n/**\r\n * Context provider Œ≥ŒπŒ± snap settings across component tree\r\n */\r\nexport interface SnapContextValue {\r\n  enabled: boolean;\r\n  tolerance: number;\r\n  enabledTypes: Set<string>;\r\n  setEnabled: (enabled: boolean) => void;\r\n  setTolerance: (tolerance: number) => void;\r\n  toggleSnapType: (type: string, enabled: boolean) => void;\r\n}\r\n\r\n// Note: Full context implementation Œ∏Œ± ŒÆœÑŒ±ŒΩ ŒµŒ¥œé\r\n// export const SnapContext = React.createContext<SnapContextValue | null>(null);\r\n// export const useSnapContext = () => { ... };\r\n\r\n// ========================================\r\n// üìä VERSION INFORMATION\r\n// ========================================\r\n\r\nexport const VERSION = '1.0.0';\r\nexport const BUILD_INFO = {\r\n  version: VERSION,\r\n  buildDate: new Date().toISOString(),\r\n  dependencies: {\r\n    engine: '@layera/snap-engine@1.0.0',\r\n    theme: '@layera/theme-switcher@workspace:*',\r\n    i18n: '@layera/i18n@workspace:*',\r\n    notifications: '@layera/notifications@workspace:*',\r\n    buttons: '@layera/buttons@workspace:*',\r\n    forms: '@layera/forms@workspace:*',\r\n    cards: '@layera/cards@workspace:*',\r\n    icons: '@layera/icons@workspace:*',\r\n    typography: '@layera/typography@workspace:*',\r\n    layout: '@layera/layout@workspace:*',\r\n    loading: '@layera/loading@workspace:*',\r\n    errorBoundary: '@layera/error-boundary@workspace:*',\r\n    viewport: '@layera/viewport@workspace:*',\r\n    constants: '@layera/constants@workspace:*'\r\n  },\r\n  features: [\r\n    'React hooks Œ≥ŒπŒ± snap integration',\r\n    'Visual snap indicators ŒºŒµ theming support',\r\n    'Interactive snap canvas ŒºŒµ touch support',\r\n    'Configurable snap settings panel',\r\n    'Mobile-optimized snap toolbar',\r\n    'Performance-aware rendering',\r\n    'Accessibility compliant',\r\n    'TypeScript strict typing',\r\n    'Error boundary protection',\r\n    'Internationalization support'\r\n  ]\r\n};\r\n\r\n// ========================================\r\n// üéØ DEFAULT EXPORT\r\n// ========================================\r\n\r\nexport { useSnapEngine as default };"]}