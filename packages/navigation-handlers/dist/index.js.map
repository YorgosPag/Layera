{"version":3,"sources":["../src/index.ts","../src/NavigationHandlersAdapter.ts","../src/useNavigationHandlers.ts"],"sourcesContent":["/**\r\n * @layera/navigation-handlers - Enterprise Navigation Handlers LEGO Package\r\n *\r\n * Single source of truth για navigation behavior στο Layera ecosystem.\r\n * Εξαχθέν από GeoMapNew.tsx για reusability και modularity.\r\n */\r\n\r\nexport * from './types';\r\nexport * from './NavigationHandlersAdapter';\r\nexport * from './useNavigationHandlers';\r\n\r\n// Convenience exports για συχνή χρήση\r\nexport { NavigationHandlersAdapter as NavigationManager } from './NavigationHandlersAdapter';\r\nexport { useSimpleNavigationHandlers as useNavHandlers } from './useNavigationHandlers';","/**\r\n * NavigationHandlersAdapter.ts - Enterprise Navigation Handlers Adapter\r\n *\r\n * Εξαγμένη λογική από GeoMapNew.tsx για navigation handlers\r\n * Single source of truth για navigation behavior στο Layera ecosystem\r\n */\r\n\r\nimport {\r\n  NavigationHandlerResult,\r\n  NavigationHandlerOptions,\r\n  NavigationHandlerDependencies,\r\n  NavigationState\r\n} from './types';\r\n\r\nexport class NavigationHandlersAdapter {\r\n  private state: NavigationState;\r\n  private options: NavigationHandlerOptions;\r\n  private dependencies: NavigationHandlerDependencies;\r\n\r\n  constructor(\r\n    dependencies: NavigationHandlerDependencies,\r\n    options: NavigationHandlerOptions = {}\r\n  ) {\r\n    this.dependencies = dependencies;\r\n    this.options = {\r\n      enableErrorRecovery: true,\r\n      logErrors: true,\r\n      ...options\r\n    };\r\n\r\n    // No internal state - use external state management via dependencies\r\n    this.state = {\r\n      showCategoryElements: false, // This will be synced with external state\r\n      isNavigating: false,\r\n      lastError: null\r\n    };\r\n  }\r\n\r\n  createHandlers(): NavigationHandlerResult {\r\n    return {\r\n      handleStepNext: this.createStepNextHandler(),\r\n      handleStepPrevious: this.createStepPreviousHandler(),\r\n      handleStepReset: this.createStepResetHandler(),\r\n      handleNewEntryClick: this.createNewEntryClickHandler(),\r\n      state: this.state,\r\n      categoryController: this.createCategoryController()\r\n    };\r\n  }\r\n\r\n  private createStepNextHandler() {\r\n    return async (): Promise<void> => {\r\n      this.state.isNavigating = true;\r\n      this.state.lastError = null;\r\n      this.notifyStateChange();\r\n\r\n      try {\r\n        await this.dependencies.navigation.goNext();\r\n      } catch (error) {\r\n        const navError = error instanceof Error ? error : new Error('Navigation next failed');\r\n        this.handleError(navError, 'goNext');\r\n      } finally {\r\n        this.state.isNavigating = false;\r\n        this.notifyStateChange();\r\n      }\r\n    };\r\n  }\r\n\r\n  private createStepPreviousHandler() {\r\n    return async (): Promise<void> => {\r\n      this.state.isNavigating = true;\r\n      this.state.lastError = null;\r\n      this.notifyStateChange();\r\n\r\n      try {\r\n        await this.dependencies.navigation.goBack();\r\n      } catch (error) {\r\n        const navError = error instanceof Error ? error : new Error('Navigation back failed');\r\n        this.handleError(navError, 'goBack');\r\n      } finally {\r\n        this.state.isNavigating = false;\r\n        this.notifyStateChange();\r\n      }\r\n    };\r\n  }\r\n\r\n  private createStepResetHandler() {\r\n    return (): void => {\r\n      try {\r\n        this.dependencies.navigation.reset();\r\n        this.dependencies.categoryElements.show(false);\r\n        this.state.showCategoryElements = false;\r\n        this.state.lastError = null;\r\n        this.notifyStateChange();\r\n      } catch (error) {\r\n        const resetError = error instanceof Error ? error : new Error('Navigation reset failed');\r\n        this.handleError(resetError, 'reset');\r\n      }\r\n    };\r\n  }\r\n\r\n  private createNewEntryClickHandler() {\r\n    return (): void => {\r\n      try {\r\n        if (this.dependencies.isSpecialDevice) {\r\n          // Special device behavior: toggle category elements using external controller\r\n          this.dependencies.categoryElements.toggle();\r\n        } else {\r\n          // Standard device behavior: delegate to external handler\r\n          // This will be handled by the external onNewEntryClick callback\r\n        }\r\n      } catch (error) {\r\n        const clickError = error instanceof Error ? error : new Error('New entry click failed');\r\n        this.handleError(clickError, 'newEntryClick');\r\n      }\r\n    };\r\n  }\r\n\r\n  private createCategoryController() {\r\n    return {\r\n      show: (value: boolean): void => {\r\n        this.state.showCategoryElements = value;\r\n        this.dependencies.categoryElements.show(value);\r\n        this.notifyStateChange();\r\n      },\r\n      toggle: (): void => {\r\n        const newState = !this.state.showCategoryElements;\r\n        this.state.showCategoryElements = newState;\r\n        this.dependencies.categoryElements.show(newState);\r\n        this.notifyStateChange();\r\n      },\r\n      onChange: this.dependencies.categoryElements.onChange\r\n    };\r\n  }\r\n\r\n  private handleError(error: Error, action: string): void {\r\n    this.state.lastError = error;\r\n\r\n    if (this.options.logErrors) {\r\n      console.error(`[NavigationHandlers] ${action} failed:`, error);\r\n    }\r\n\r\n    if (this.options.onError) {\r\n      this.options.onError(error, action);\r\n    }\r\n\r\n    this.notifyStateChange();\r\n  }\r\n\r\n  private notifyStateChange(): void {\r\n    if (this.options.onStateChange) {\r\n      this.options.onStateChange({ ...this.state });\r\n    }\r\n  }\r\n\r\n  // Public method to update dependencies (useful for React hooks)\r\n  updateDependencies(dependencies: Partial<NavigationHandlerDependencies>): void {\r\n    this.dependencies = { ...this.dependencies, ...dependencies };\r\n  }\r\n\r\n  // Public method to get current state\r\n  getState(): NavigationState {\r\n    return { ...this.state };\r\n  }\r\n}","/**\r\n * useNavigationHandlers.ts - Enterprise React Hook για Navigation Handlers\r\n *\r\n * React hook που παρέχει ready-to-use navigation handlers με error handling\r\n */\r\n\r\nimport { useState, useCallback, useMemo, useEffect } from 'react';\r\nimport { NavigationHandlersAdapter } from './NavigationHandlersAdapter';\r\nimport {\r\n  NavigationHandlerResult,\r\n  NavigationHandlerOptions,\r\n  NavigationActions,\r\n  NavigationState\r\n} from './types';\r\n\r\nexport interface UseNavigationHandlersConfig {\r\n  navigation: NavigationActions;\r\n  isSpecialDevice?: boolean;\r\n  onCategoryElementsChange?: (show: boolean) => void;\r\n  onNewEntryClick?: () => void;\r\n  options?: NavigationHandlerOptions;\r\n}\r\n\r\nexport interface UseNavigationHandlersResult extends NavigationHandlerResult {\r\n  // Additional React-specific utilities\r\n  updateSpecialDevice: (isSpecial: boolean) => void;\r\n  refreshHandlers: () => void;\r\n}\r\n\r\nexport function useNavigationHandlers(\r\n  config: UseNavigationHandlersConfig\r\n): UseNavigationHandlersResult {\r\n  const [showCategoryElements, setShowCategoryElements] = useState(false);\r\n  const [isSpecialDevice, setIsSpecialDevice] = useState(config.isSpecialDevice ?? false);\r\n\r\n  // Sync isSpecialDevice with config changes\r\n  useEffect(() => {\r\n    setIsSpecialDevice(config.isSpecialDevice ?? false);\r\n  }, [config.isSpecialDevice]);\r\n\r\n  // Create category elements controller\r\n  const categoryElementsController = useMemo(() => ({\r\n    show: (value: boolean) => {\r\n      setShowCategoryElements(value);\r\n      config.onCategoryElementsChange?.(value);\r\n    },\r\n    toggle: () => {\r\n      const newState = !showCategoryElements;\r\n      setShowCategoryElements(newState);\r\n      config.onCategoryElementsChange?.(newState);\r\n    },\r\n    onChange: config.onCategoryElementsChange\r\n  }), [showCategoryElements, config.onCategoryElementsChange]);\r\n\r\n  // Create adapter with dependencies\r\n  const adapter = useMemo(() => {\r\n    const dependencies = {\r\n      navigation: config.navigation,\r\n      categoryElements: categoryElementsController,\r\n      isSpecialDevice\r\n    };\r\n\r\n    return new NavigationHandlersAdapter(dependencies, config.options);\r\n  }, [config.navigation, categoryElementsController, isSpecialDevice, config.options]);\r\n\r\n  // Create handlers from adapter\r\n  const handlers = useMemo(() => {\r\n    const adapterHandlers = adapter.createHandlers();\r\n\r\n    // Override handleNewEntryClick to support external callback\r\n    const originalHandleNewEntryClick = adapterHandlers.handleNewEntryClick;\r\n    const enhancedHandleNewEntryClick = () => {\r\n      if (isSpecialDevice) {\r\n        // Special device: use ONLY adapter logic (stepper/category elements)\r\n        originalHandleNewEntryClick();\r\n      } else {\r\n        // Standard device: delegate to external handler (unified pipeline)\r\n        config.onNewEntryClick?.();\r\n      }\r\n    };\r\n\r\n    return {\r\n      ...adapterHandlers,\r\n      handleNewEntryClick: enhancedHandleNewEntryClick\r\n    };\r\n  }, [adapter, isSpecialDevice, config.onNewEntryClick]);\r\n\r\n  // React-specific utilities\r\n  const updateSpecialDevice = useCallback((isSpecial: boolean) => {\r\n    setIsSpecialDevice(isSpecial);\r\n  }, []);\r\n\r\n  const refreshHandlers = useCallback(() => {\r\n    // Force re-creation of handlers by updating adapter dependencies\r\n    adapter.updateDependencies({\r\n      categoryElements: categoryElementsController,\r\n      isSpecialDevice\r\n    });\r\n  }, [adapter, categoryElementsController, isSpecialDevice]);\r\n\r\n  // Create reactive state\r\n  const state: NavigationState = {\r\n    showCategoryElements,\r\n    isNavigating: false, // This could be enhanced to track real navigation state\r\n    lastError: null     // This could be enhanced to track real errors\r\n  };\r\n\r\n  return {\r\n    ...handlers,\r\n    state,\r\n    categoryController: categoryElementsController,\r\n    updateSpecialDevice,\r\n    refreshHandlers\r\n  };\r\n}\r\n\r\n// Convenience hook για συχνή χρήση\r\nexport function useSimpleNavigationHandlers(\r\n  navigation: NavigationActions,\r\n  isSpecialDevice = false\r\n) {\r\n  return useNavigationHandlers({\r\n    navigation,\r\n    isSpecialDevice\r\n  });\r\n}"],"mappings":"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","names":[]}