{"version":3,"sources":["../src/services/fallbackBoundaries.ts","../src/services/osmService.ts","../src/index.ts"],"names":["findFallbackBoundary"],"mappings":"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","file":"index.cjs","sourcesContent":["/**\r\n * @layera/geo-mapping - Fallback Boundaries Configuration\r\n *\r\n * Type-safe configuration Œ≥ŒπŒ± fallback polygons œåœÑŒ±ŒΩ œÑŒø OSM API Œ±œÄŒøœÑœÖŒ≥œáŒ¨ŒΩŒµŒπ.\r\n * ŒöŒëŒúŒôŒë œáœÅŒÆœÉŒ∑ any - TypeScript strict mode.\r\n */\r\n\r\nimport type { GeoJSONFeatureCollection } from '@layera/geo-core';\r\n\r\n/**\r\n * Fallback boundary configuration\r\n */\r\ninterface FallbackBoundary {\r\n  /** Unique keys Œ≥ŒπŒ± matching (ŒºœÄŒøœÅŒµŒØ ŒΩŒ± œÄŒµœÅŒπŒ≠œáŒµŒπ variations) */\r\n  keys: string[];\r\n  /** Display name Œ≥ŒπŒ± œÑŒø boundary */\r\n  name: string;\r\n  /** Admin level Œ±œÄœå OSM */\r\n  adminLevel: string;\r\n  /** Polygon coordinates [lng, lat][] */\r\n  coordinates: number[][];\r\n}\r\n\r\n/**\r\n * Type-safe fallback boundaries registry\r\n *\r\n * Œ£ŒóŒúŒïŒôŒ©Œ£Œó: ŒëœÖœÑœå ŒµŒØŒΩŒ±Œπ œÄœÅŒøœÉœâœÅŒπŒΩŒÆ ŒªœçœÉŒ∑. Œ§Œø œÉœâœÉœÑœå ŒµŒØŒΩŒ±Œπ ŒΩŒ± Œ¥ŒπŒøœÅŒ∏œâŒ∏ŒµŒØ\r\n * œÑŒø OSM API integration Œ≥ŒπŒ± Œ∫Œ±Œ∏ŒøŒªŒπŒ∫ŒÆ œÖœÄŒøœÉœÑŒÆœÅŒπŒæŒ∑ œÄŒµœÅŒπŒøœáœéŒΩ.\r\n *\r\n * ŒúŒ≠œáœÅŒπ œÑœåœÑŒµ, œÄœÅŒøœÉŒ∏Œ≠œÑŒøœÖŒºŒµ ŒºœåŒΩŒø critical œÄŒµœÅŒπŒøœáŒ≠œÇ ŒµŒ¥œé.\r\n */\r\nconst FALLBACK_BOUNDARIES: FallbackBoundary[] = [\r\n  // ŒòŒµœÉœÉŒ±ŒªŒøŒΩŒØŒ∫Œ∑ - ŒöŒ≠ŒΩœÑœÅŒø\r\n  {\r\n    keys: ['ŒòŒµœÉœÉŒ±ŒªŒøŒΩŒØŒ∫Œ∑œÇ', 'Thessaloniki', 'ŒòŒµœÉœÉŒ±ŒªŒøŒΩŒØŒ∫Œ∑'],\r\n    name: 'ŒîŒÆŒºŒøœÇ ŒòŒµœÉœÉŒ±ŒªŒøŒΩŒØŒ∫Œ∑œÇ',\r\n    adminLevel: '8',\r\n    coordinates: [\r\n      // Simplified boundary Œ≥ŒπŒ± demo - œÉœÑŒ∑ŒΩ œÄœÅŒ¨ŒæŒ∑ Œ∏Œ± œáœÅŒµŒπŒ¨Œ∂ŒµœÑŒ±Œπ œÄŒªŒÆœÅŒµœÇ polygon\r\n      [22.9352, 40.6401], [22.9600, 40.6401], [22.9600, 40.6250],\r\n      [22.9352, 40.6250], [22.9352, 40.6401]\r\n    ]\r\n  },\r\n\r\n  // ŒúŒ±Œ∫ŒµŒ¥ŒøŒΩŒØŒ± regions\r\n  {\r\n    keys: ['ŒöŒµŒΩœÑœÅŒπŒ∫ŒÆœÇ ŒúŒ±Œ∫ŒµŒ¥ŒøŒΩŒØŒ±œÇ', 'Central Macedonia', 'ŒöŒµŒΩœÑœÅŒπŒ∫ŒÆ ŒúŒ±Œ∫ŒµŒ¥ŒøŒΩŒØŒ±'],\r\n    name: 'Œ†ŒµœÅŒπœÜŒ≠œÅŒµŒπŒ± ŒöŒµŒΩœÑœÅŒπŒ∫ŒÆœÇ ŒúŒ±Œ∫ŒµŒ¥ŒøŒΩŒØŒ±œÇ',\r\n    adminLevel: '4',\r\n    coordinates: [\r\n      // Simplified boundary Œ≥ŒπŒ± demo\r\n      [22.0, 41.5], [24.5, 41.5], [24.5, 40.0],\r\n      [22.0, 40.0], [22.0, 41.5]\r\n    ]\r\n  },\r\n\r\n  // ŒëŒºœÄŒµŒªœåŒ∫Œ∑œÄŒøŒπ (existing)\r\n  {\r\n    keys: ['ŒëŒºœÄŒµŒªŒøŒ∫ŒÆœÄœâŒΩ', 'Ampelokipon', '–ê–º–ø–µ–ª–æ–∫–∏–ø–æ–Ω', 'ŒëŒºœÄŒµŒªœåŒ∫Œ∑œÄŒøŒπ'],\r\n    name: 'ŒîŒ∑ŒºŒøœÑŒπŒ∫ŒÆ ŒïŒΩœåœÑŒ∑œÑŒ± ŒëŒºœÄŒµŒªŒøŒ∫ŒÆœÄœâŒΩ',\r\n    adminLevel: '8',\r\n    coordinates: [\r\n      [22.9166013, 40.6545235], [22.916378, 40.6548432], [22.9161263, 40.654913],\r\n      [22.9159367, 40.6551479], [22.9157414, 40.6553883], [22.9155318, 40.655694],\r\n      [22.9155987, 40.6558613], [22.9154793, 40.6562918], [22.915702, 40.6565594],\r\n      [22.9150123, 40.6571562], [22.914356, 40.6575815], [22.9141897, 40.6577716],\r\n      [22.913965, 40.6580476], [22.9137682, 40.6584715], [22.9130735, 40.6595013],\r\n      [22.9146819, 40.6606645], [22.9195995, 40.6611276], [22.922064, 40.6603006],\r\n      [22.9243559, 40.6589395], [22.928998, 40.6570252], [22.9316767, 40.6565356],\r\n      [22.934234, 40.6567998], [22.9345673, 40.6568327], [22.9344419, 40.6563954],\r\n      [22.9345299, 40.6555972], [22.9346904, 40.654914], [22.9352047, 40.6527174],\r\n      [22.9342228, 40.6523744], [22.9341515, 40.651373], [22.9341167, 40.6510887],\r\n      [22.9340592, 40.6505896], [22.9339901, 40.6498829], [22.9340715, 40.6493217],\r\n      [22.9339464, 40.6484215], [22.9326998, 40.6484637], [22.931444, 40.6490899],\r\n      [22.9313272, 40.6491772], [22.9303401, 40.6495824], [22.929558, 40.6496515],\r\n      [22.9280302, 40.6497943], [22.9267611, 40.6494903], [22.9256199, 40.6492281],\r\n      [22.9243866, 40.6489393], [22.9239727, 40.6488403], [22.9195478, 40.6508989],\r\n      [22.919069, 40.6511528], [22.9186956, 40.651313], [22.9184825, 40.6514636],\r\n      [22.9183194, 40.6516322], [22.9181684, 40.6518332], [22.9180779, 40.6520084],\r\n      [22.9180263, 40.6522166], [22.9179568, 40.6523848], [22.9178432, 40.6525894],\r\n      [22.9171589, 40.6536558], [22.9166013, 40.6545235]\r\n    ]\r\n  }\r\n];\r\n\r\n/**\r\n * ŒíœÅŒØœÉŒ∫ŒµŒπ fallback boundary ŒºŒµ Œ≤Œ¨œÉŒ∑ search terms\r\n */\r\nexport const findFallbackBoundary = (\r\n  searchTerms: string[]\r\n): GeoJSONFeatureCollection | null => {\r\n  // Normalize search terms\r\n  const normalizedSearchTerms = searchTerms\r\n    .filter(term => term && typeof term === 'string')\r\n    .map(term => term.toLowerCase().trim());\r\n\r\n  // ŒëŒΩŒ±Œ∂ŒÆœÑŒ∑œÉŒ∑ Œ≥ŒπŒ± matching boundary\r\n  for (const boundary of FALLBACK_BOUNDARIES) {\r\n    const matches = boundary.keys.some(key => {\r\n      const normalizedKey = key.toLowerCase();\r\n      return normalizedSearchTerms.some(searchTerm =>\r\n        searchTerm.includes(normalizedKey) || normalizedKey.includes(searchTerm)\r\n      );\r\n    });\r\n\r\n    if (matches) {\r\n      console.log(`‚úÖ Fallback boundary found Œ≥ŒπŒ±: ${boundary.name}`);\r\n      return {\r\n        type: 'FeatureCollection',\r\n        features: [{\r\n          type: 'Feature',\r\n          properties: {\r\n            name: boundary.name,\r\n            admin_level: boundary.adminLevel,\r\n            boundary: 'administrative'\r\n          },\r\n          geometry: {\r\n            type: 'Polygon',\r\n            coordinates: [boundary.coordinates]\r\n          }\r\n        }]\r\n      };\r\n    }\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\n/**\r\n * Œ†œÅŒøœÉŒ∏Œ≠œÑŒµŒπ ŒΩŒ≠Œø fallback boundary\r\n */\r\nexport const addFallbackBoundary = (boundary: FallbackBoundary): void => {\r\n  // ŒàŒªŒµŒ≥œáŒøœÇ Œ≥ŒπŒ± duplicates\r\n  const exists = FALLBACK_BOUNDARIES.some(b =>\r\n    b.keys.some(key => boundary.keys.includes(key))\r\n  );\r\n\r\n  if (!exists) {\r\n    FALLBACK_BOUNDARIES.push(boundary);\r\n    console.log(`üìç Added fallback boundary: ${boundary.name}`);\r\n  }\r\n};\r\n\r\n/**\r\n * ŒïœÄŒπœÉœÑœÅŒ≠œÜŒµŒπ œåŒªŒ± œÑŒ± Œ¥ŒπŒ±Œ∏Œ≠œÉŒπŒºŒ± fallback boundaries\r\n */\r\nexport const getAllFallbackBoundaries = (): readonly FallbackBoundary[] => {\r\n  return FALLBACK_BOUNDARIES;\r\n};\r\n\r\n/**\r\n * ŒöŒ±Œ∏Œ±œÅŒØŒ∂ŒµŒπ œåŒªŒ± œÑŒ± fallback boundaries (Œ≥ŒπŒ± testing)\r\n */\r\nexport const clearFallbackBoundaries = (): void => {\r\n  FALLBACK_BOUNDARIES.length = 0;\r\n};","import { OSMAdminCollection } from '../types/index';\r\n\r\n/**\r\n * Fetch administrative boundary for address component using Enterprise BoundaryService\r\n * @param addressComponent - Component ŒºŒµ label Œ∫Œ±Œπ type\r\n * @returns OSM-style admin boundary collection\r\n */\r\nexport const fetchBoundaryByAddressComponent = async (\r\n  addressComponent: { label: string; type: string }\r\n): Promise<OSMAdminCollection> => {\r\n  try {\r\n    console.log(`üåç Direct OSM Overpass API Œ≥ŒπŒ±: ${addressComponent.label}`);\r\n\r\n    // ŒìŒπŒ± œÑœéœÅŒ± ŒµœÄŒπœÉœÑœÅŒ≠œÜŒøœÖŒºŒµ placeholder boundary Œ≥ŒπŒ± Rome\r\n    // TODO: ŒîŒπœåœÅŒ∏œâœÉŒ∑ œÑŒøœÖ Overpass query Œ≥ŒπŒ± œÄœÅŒ±Œ≥ŒºŒ±œÑŒπŒ∫Œ¨ boundaries\r\n    if (addressComponent.label.toLowerCase() === 'rome') {\r\n      console.log(`‚úÖ Returning placeholder boundary Œ≥ŒπŒ± Rome`);\r\n\r\n      // Placeholder bounding box Œ≥ŒπŒ± œÑŒ∑ Œ°œéŒºŒ∑\r\n      const romeBounds = {\r\n        north: 42.0505,\r\n        south: 41.7555,\r\n        east: 12.6569,\r\n        west: 12.3545\r\n      };\r\n\r\n      return {\r\n        type: 'FeatureCollection',\r\n        features: [{\r\n          type: 'Feature',\r\n          properties: {\r\n            name: 'Rome',\r\n            admin_level: '8',\r\n            boundary: 'administrative',\r\n            osm_id: 41485,\r\n            osm_type: 'relation'\r\n          },\r\n          geometry: {\r\n            type: 'Polygon',\r\n            coordinates: [[\r\n              [romeBounds.west, romeBounds.north],\r\n              [romeBounds.east, romeBounds.north],\r\n              [romeBounds.east, romeBounds.south],\r\n              [romeBounds.west, romeBounds.south],\r\n              [romeBounds.west, romeBounds.north]\r\n            ]]\r\n          }\r\n        }]\r\n      };\r\n    }\r\n\r\n    // Default Overpass query Œ≥ŒπŒ± Œ¨ŒªŒªŒµœÇ œÑŒøœÄŒøŒ∏ŒµœÉŒØŒµœÇ\r\n    const query = `\r\n      [out:json][timeout:10];\r\n      (\r\n        relation[\"boundary\"=\"administrative\"][\"name\"~\"${addressComponent.label}\",i];\r\n      );\r\n      out ids;\r\n    `;\r\n\r\n    const response = await fetch('https://overpass-api.de/api/interpreter', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/x-www-form-urlencoded',\r\n      },\r\n      body: `data=${encodeURIComponent(query)}`\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Overpass API error: ${response.status}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n\r\n    if (data.elements && data.elements.length > 0) {\r\n      console.log(`‚úÖ OSM boundary IDs found Œ≥ŒπŒ±: ${addressComponent.label} (${data.elements.length} elements)`);\r\n\r\n      // Œ†œÅŒøœÉœâœÅŒπŒΩŒ¨ ŒµœÄŒπœÉœÑœÅŒ≠œÜŒøœÖŒºŒµ Œ≠ŒΩŒ± Œ±œÄŒªœå bounding box\r\n      return {\r\n        type: 'FeatureCollection',\r\n        features: [{\r\n          type: 'Feature',\r\n          properties: {\r\n            name: addressComponent.label,\r\n            admin_level: '8',\r\n            boundary: 'administrative',\r\n            osm_id: data.elements[0].id,\r\n            osm_type: 'relation'\r\n          },\r\n          geometry: {\r\n            type: 'Polygon',\r\n            coordinates: [[\r\n              [-0.1, -0.1],\r\n              [0.1, -0.1],\r\n              [0.1, 0.1],\r\n              [-0.1, 0.1],\r\n              [-0.1, -0.1]\r\n            ]]\r\n          }\r\n        }]\r\n      };\r\n    }\r\n\r\n    console.log(`‚ö†Ô∏è No OSM boundary found Œ≥ŒπŒ±: ${addressComponent.label}`);\r\n    return {\r\n      type: 'FeatureCollection',\r\n      features: []\r\n    };\r\n\r\n  } catch (error) {\r\n    console.error(`üö´ OSM API error Œ≥ŒπŒ± ${addressComponent.label}:`, error);\r\n\r\n    // Fallback to local boundary system\r\n    console.log(`‚ö†Ô∏è Fallback to local boundary system Œ≥ŒπŒ±: ${addressComponent.label}`);\r\n    return await fetchLocalBoundary(addressComponent);\r\n  }\r\n};\r\n\r\n/**\r\n * Fallback boundary fetch using local system\r\n */\r\nasync function fetchLocalBoundary(\r\n  addressComponent: { label: string; type: string }\r\n): Promise<OSMAdminCollection> {\r\n  // Basic query normalization\r\n  const baseName = addressComponent.label\r\n    .replace(/^ŒîŒÆŒºŒøœÇ\\s+/, '')\r\n    .replace(/^ŒîŒ∑ŒºŒøœÑŒπŒ∫ŒÆ\\s+ŒïŒΩœåœÑŒ∑œÑŒ±\\s+/, '')\r\n    .replace(/^Œ†ŒµœÅŒπœÜŒ≠œÅŒµŒπŒ±\\s+/, '')\r\n    .replace(/^Œ†ŒµœÅŒπœÜŒµœÅŒµŒπŒ±Œ∫ŒÆ\\s+ŒïŒΩœåœÑŒ∑œÑŒ±\\s+/, '')\r\n    .replace(/\\s+-\\s+.*$/, '')\r\n    .replace(/\\s+\\(.+\\)$/, '')\r\n    .trim();\r\n\r\n  console.log('‚ö†Ô∏è Fallback to local boundary system Œ≥ŒπŒ±:', baseName);\r\n\r\n  // Use existing fallback system if available\r\n  try {\r\n    const { findFallbackBoundary } = await import('./fallbackBoundaries');\r\n    const searchTerms = [addressComponent.label, baseName];\r\n    const fallbackBoundary = findFallbackBoundary(searchTerms);\r\n\r\n    if (fallbackBoundary) {\r\n      console.log('‚úÖ Local fallback boundary found');\r\n      return fallbackBoundary;\r\n    }\r\n  } catch (fallbackError) {\r\n    console.warn('‚ö†Ô∏è Fallback system not available:', fallbackError);\r\n  }\r\n\r\n  // Ultimate fallback: empty collection\r\n  console.error('üö´ No boundary data available Œ≥ŒπŒ±:', addressComponent.label);\r\n  return {\r\n    type: 'FeatureCollection',\r\n    features: []\r\n  };\r\n}\r\n\r\n// Stub functions Œ≥ŒπŒ± compatibility\r\nexport const fetchBuildingOutlines = async () => ({ type: 'FeatureCollection', features: [] });\r\nexport const fetchAdministrativeBoundary = async () => ({ type: 'FeatureCollection', features: [] });\r\nexport const clearOSMCache = async () => {};\r\nexport const getCacheSize = () => 0;\r\nexport const isBoundsCached = () => false;\r\nexport const prefetchBuildingOutlines = async () => {};\r\n\r\n/**\r\n * Convert OSM geometry to GeoJSON geometry\r\n */\r\nfunction convertOSMGeometry(element: any): any {\r\n  if (!element.geometry) return null;\r\n\r\n  if (element.type === 'relation') {\r\n    // For relations, try to build polygon from ways\r\n    const coordinates: number[][][] = [];\r\n\r\n    if (element.geometry && element.geometry.length > 0) {\r\n      const outerRing: number[][] = [];\r\n\r\n      element.geometry.forEach((geom: any) => {\r\n        if (geom.lat && geom.lon) {\r\n          outerRing.push([geom.lon, geom.lat]);\r\n        }\r\n      });\r\n\r\n      if (outerRing.length > 2) {\r\n        // Close the ring if needed\r\n        if (outerRing[0][0] !== outerRing[outerRing.length - 1][0] ||\r\n            outerRing[0][1] !== outerRing[outerRing.length - 1][1]) {\r\n          outerRing.push([...outerRing[0]]);\r\n        }\r\n        coordinates.push(outerRing);\r\n      }\r\n    }\r\n\r\n    if (coordinates.length > 0) {\r\n      return {\r\n        type: 'Polygon',\r\n        coordinates: coordinates\r\n      };\r\n    }\r\n  }\r\n\r\n  if (element.type === 'way') {\r\n    const coordinates: number[][] = [];\r\n\r\n    if (element.geometry) {\r\n      element.geometry.forEach((geom: any) => {\r\n        if (geom.lat && geom.lon) {\r\n          coordinates.push([geom.lon, geom.lat]);\r\n        }\r\n      });\r\n    }\r\n\r\n    if (coordinates.length > 2) {\r\n      // Close the ring if needed for polygon\r\n      if (coordinates[0][0] !== coordinates[coordinates.length - 1][0] ||\r\n          coordinates[0][1] !== coordinates[coordinates.length - 1][1]) {\r\n        coordinates.push([...coordinates[0]]);\r\n      }\r\n\r\n      return {\r\n        type: 'Polygon',\r\n        coordinates: [coordinates]\r\n      };\r\n    }\r\n  }\r\n\r\n  return null;\r\n}","/**\r\n * @layera/geo-mapping\r\n *\r\n * OSM services, administrative boundaries, Œ∫Œ±Œπ external mapping APIs.\r\n * Enterprise Architecture: Business Domain Layer\r\n *\r\n * Depends on: @layera/geo-core, @layera/constants\r\n * Used by: @layera/geo-drawing, @layera/search-module, @layera/map-module\r\n */\r\n\r\n// OSM Services\r\nexport {\r\n  fetchBuildingOutlines,\r\n  fetchAdministrativeBoundary,\r\n  fetchBoundaryByAddressComponent,\r\n  clearOSMCache,\r\n  getCacheSize,\r\n  isBoundsCached,\r\n  prefetchBuildingOutlines\r\n} from './services/osmService';\r\n\r\n// Package metadata\r\nexport const GEO_MAPPING_VERSION = '1.0.0';\r\nexport const GEO_MAPPING_NAME = '@layera/geo-mapping';"]}